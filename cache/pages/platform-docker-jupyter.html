<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="DataScientist-&#47484;-&#50948;&#54620;-Jupyter-Docker">DataScientist &#47484; &#50948;&#54620; Jupyter Docker<a class="anchor-link" href="#DataScientist-&#47484;-&#50948;&#54620;-Jupyter-Docker">&#182;</a></h1><p>Data Science 에 자주 사용되는 Jupyter 와 Spark, CPU/GPU DeepLearning 및 주요 Library 를 Docker Image 로 제공합니다.</p>
<p>현재 지원 기능</p>
<ul>
<li>Jupyter<ul>
<li>Jupyter Kernel: Python3, Scala, R, Julia</li>
<li>Machine Learning<ul>
<li>Python3 Lib: tensorflow CPU/GPU, pytorch CPU/GPU, keras, pandas, scikit-learn, .. etc</li>
</ul>
</li>
</ul>
</li>
<li>Apache Spark</li>
</ul>
<p>시스템 요구사항</p>
<ul>
<li>Ubuntu 18.04 LTS</li>
<li>Docker</li>
<li>Nvidia-Docker (for GPU)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Git-Clone">Git Clone<a class="anchor-link" href="#Git-Clone">&#182;</a></h2><div class="highlight"><pre><span></span>&gt; git clone https://github.com/comafire/docker-jupyter.git
</pre></div>
<h2 id="Install-Docker">Install Docker<a class="anchor-link" href="#Install-Docker">&#182;</a></h2><p>Docker 공식 설치 문서를 참조하여 설치하시면 됩니다.</p>
<p><a href="https://docs.docker.com/engine/installation/linux/ubuntu/">https://docs.docker.com/engine/installation/linux/ubuntu/</a></p>
<p><a href="https://docs.docker.com/engine/installation/linux/linux-postinstall/">https://docs.docker.com/engine/installation/linux/linux-postinstall/</a></p>
<h2 id="for-Nvidia-GPU">for Nvidia GPU<a class="anchor-link" href="#for-Nvidia-GPU">&#182;</a></h2><p>Nvidia GPU 가 장착된 머신이라면 아래 Nvidia GPU Driver 와 Nvidia-Docker 설치를 통해서 GPU DeepLarning 라이브러리를 사용하실 수 있습니다.</p>
<h3 id="Install-Nvidia-GPU-Driver">Install Nvidia GPU Driver<a class="anchor-link" href="#Install-Nvidia-GPU-Driver">&#182;</a></h3><p>Cuda 및 툴킷 라이브러니는 Nvidia-Docker 를 사용할 것이기에 Driver 만 설치하면 됩니다.</p>
<p>설치 방법은 아래 링크를 참조하세요.</p>
<p><a href="https://linuxconfig.org/how-to-install-the-nvidia-drivers-on-ubuntu-18-04-bionic-beaver-linux">https://linuxconfig.org/how-to-install-the-nvidia-drivers-on-ubuntu-18-04-bionic-beaver-linux</a></p>
<h3 id="Install-Nvidia-Docker">Install Nvidia-Docker<a class="anchor-link" href="#Install-Nvidia-Docker">&#182;</a></h3><p>Docker 상에서 Nvidia GPU 를 이용하기 위해 Nvidia-Docker 를 사용합니다.</p>
<p>설치 방법은 아래 공식 설치 문서를 참조하세요.</p>
<p><a href="https://github.com/NVIDIA/nvidia-docker">https://github.com/NVIDIA/nvidia-docker</a></p>
<h2 id="Setup">Setup<a class="anchor-link" href="#Setup">&#182;</a></h2><p>env.sh.template 파일을 env.sh 로 복사하여 설정 변경이 가능합니다.</p>
<div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="nb">export</span> <span class="nv">HOSTNAME</span><span class="o">=</span><span class="s2">&quot;docker-jupyter&quot;</span> 
<span class="nb">export</span> <span class="nv">USERNAME</span><span class="o">=</span><span class="k">$(</span>id -un<span class="k">)</span> 
<span class="nb">export</span> <span class="nv">USERID</span><span class="o">=</span><span class="k">$(</span>id -u <span class="nv">$USERNAME</span><span class="k">)</span>
<span class="nb">export</span> <span class="nv">LOCALE</span><span class="o">=</span><span class="s2">&quot;ko_KR.UTF-8&quot;</span>

<span class="c1"># Jupyter</span>
<span class="nb">export</span> <span class="nv">JUPYTER_NAME</span><span class="o">=</span><span class="s2">&quot;jupyter&quot;</span>
<span class="nb">export</span> <span class="nv">JUPYTER_PORT</span><span class="o">=</span><span class="s2">&quot;8010&quot;</span> <span class="c1"># Your Jupyter Port</span>
<span class="nb">export</span> <span class="nv">JUPYTER_HOME</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="nb">export</span> <span class="nv">JUPYTER_MNT</span><span class="o">=</span><span class="s2">&quot;/data&quot;</span> <span class="c1"># Your External Mount</span>
<span class="nb">export</span> <span class="nv">JUPYTER_PASSWORD</span><span class="o">=</span><span class="s2">&quot;notebooks&quot;</span> <span class="c1"># Your Jupyter Password</span>
<span class="nb">export</span> <span class="nv">JUPYTER_BASEURL</span><span class="o">=</span><span class="s2">&quot;jupyter&quot;</span> <span class="c1"># Your Jupyter BaseURL, ex) http://localhost:8010/jupyter</span>
<span class="nb">export</span> <span class="nv">JUPYTER_RESTAPIPORT</span><span class="o">=</span><span class="s2">&quot;8020&quot;</span> <span class="c1"># Your Jupyter Kernel Gateway Port</span>
<span class="nb">export</span> <span class="nv">JUPYTER_IMAGE</span><span class="o">=</span><span class="s2">&quot;comafire/docker-jupyter&quot;</span>
<span class="nb">export</span> <span class="nv">JUPYTER_TAG</span><span class="o">=</span><span class="s2">&quot;latest&quot;</span>
<span class="nb">export</span> <span class="nv">JUPYTER_GPU_IMAGE</span><span class="o">=</span><span class="s2">&quot;comafire/docker-jupyter-gpu&quot;</span>
<span class="nb">export</span> <span class="nv">JUPYTER_GPU_TAG</span><span class="o">=</span><span class="s2">&quot;latest&quot;</span>
<span class="nb">export</span> <span class="nv">JUPYTER_GPU</span><span class="o">=</span><span class="s2">&quot;FALSE&quot;</span>
</pre></div>
<h2 id="Build-Docker-Image">Build Docker Image<a class="anchor-link" href="#Build-Docker-Image">&#182;</a></h2><p>./docker_build.sh 명령을 통해 env.sh 에서 설정한 이미지를 빌드합니다.</p>
<p>Dockerfile 을 제공하므로 커스텀 이미지 빌드도 가능합니다.</p>
<h2 id="Run">Run<a class="anchor-link" href="#Run">&#182;</a></h2><p>./docker_run_jupyter.sh 명령으로 Jupyter Docker 이미지를 실행할 수 있습니다.</p>
<div class="highlight"><pre><span></span>&gt; ./docker_run_jupyter.sh
&gt; docker ps
CONTAINER ID        IMAGE                                COMMAND              CREATED             STATUS              PORTS                                            NAMES
c63e1132d207        comafire/docker-jupyter:latest       <span class="s2">&quot;./run_jupyter.sh&quot;</span>   <span class="m">2</span> seconds ago       Up <span class="m">1</span> second         <span class="m">0</span>.0.0.0:8020-&gt;8088/tcp, <span class="m">0</span>.0.0.0:8010-&gt;8888/tcp   jupyter
</pre></div>
<p>이제, 설정한 Jupyter URL 인 <a href="http://localhost:8010/jupyter">http://localhost:8010/jupyter</a> 로 접속하여 Jupyter를 사용할 수 있습니다.</p>
<h2 id="Install-Extra-Library">Install Extra Library<a class="anchor-link" href="#Install-Extra-Library">&#182;</a></h2><h3 id="Python">Python<a class="anchor-link" href="#Python">&#182;</a></h3><p>Jupyter 사용중 추가 외부 라이브러리가 필요하시면 Jupyter 상에서 Terminal 창을 띄우신 후에 pip3 명령을 사용하시면 됩니다.</p>
<p>Docker 실행시 자동 설치를 원하시면 requirements.txt 파일에 패키지를 추가하시면 됩니다.</p>
<h2 id="Option---Vagrant">Option - Vagrant<a class="anchor-link" href="#Option---Vagrant">&#182;</a></h2><p>Linux 에서 Virtual Box Virtual Machine 을 편리하게 관리하기 위한 툴로 Vagrant를 이용합니다.</p>
<p>docker-jupyter 를 로컬 머신상이 아닌 Virtual Machine 상에서 설치 테스트를 하기 위해 사용합니다.</p>
<h3 id="Install-Vagrant">Install Vagrant<a class="anchor-link" href="#Install-Vagrant">&#182;</a></h3><p>Vagrant를 아래 명령으로 설치 합니다. vagrant 의 virtual box disk 사이즈 설정 플러그인 기능을 사용하기 위해 특정 버전의 vagrant 를 설치합니다.</p>
<div class="highlight"><pre><span></span>wget -q https://www.virtualbox.org/download/oracle_vbox_2016.asc -O- <span class="p">|</span> sudo apt-key add -
wget -q https://www.virtualbox.org/download/oracle_vbox.asc -O- <span class="p">|</span> sudo apt-key add -
sudo add-apt-repository <span class="s2">&quot;deb [arch=amd64] http://download.virtualbox.org/virtualbox/debian </span><span class="k">$(</span>lsb_release -cs<span class="k">)</span><span class="s2"> contrib&quot;</span>
sudo apt update
sudo apt install virtualbox virtualbox-ext-pack
wget -c https://releases.hashicorp.com/vagrant/2.0.3/vagrant_2.0.3_x86_64.deb -P /tmp
sudo dpkg -i /tmp/vagrant_2.0.3_x86_64.deb
vagrant plugin install vagrant-disksize
</pre></div>
<h3 id="Vagrantfile">Vagrantfile<a class="anchor-link" href="#Vagrantfile">&#182;</a></h3><p>Virtual Machine 에서 사용할 네트워크/메모리/디스크 설정은 Vagrantfile 파일에서 자신에 맞게 수정하면 됩니다.</p>
<p>docker-jupyter 디렉토리는 Virtual box 내에 /home/vagrant/docker-jupyter 와 마운트되게 됩니다.</p>
<div class="highlight"><pre><span></span>ENV<span class="o">[</span><span class="s2">&quot;LC_ALL&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;en_US.UTF-8&quot;</span>

Vagrant.configure<span class="o">(</span><span class="s2">&quot;2&quot;</span><span class="o">)</span> <span class="k">do</span> <span class="p">|</span>config<span class="p">|</span>

  config.vm.define <span class="s2">&quot;v01&quot;</span> <span class="k">do</span> <span class="p">|</span>host<span class="p">|</span>
    host.vm.box <span class="o">=</span> <span class="s2">&quot;ubuntu/xenial64&quot;</span>
    host.vm.hostname <span class="o">=</span> <span class="s2">&quot;v01&quot;</span>
    host.vm.network <span class="s2">&quot;public_network&quot;</span>, ip: <span class="s2">&quot;192.168.0.70&quot;</span>
    <span class="c1">#host.vm.network &quot;private_network&quot;, ip: &quot;10.0.1.1&quot;</span>
    host.vm.provider <span class="s2">&quot;virtualbox&quot;</span> <span class="k">do</span> <span class="p">|</span>vb<span class="p">|</span>
      vb.gui <span class="o">=</span> <span class="nb">false</span>
      vb.cpus <span class="o">=</span> <span class="m">2</span>
      vb.memory <span class="o">=</span> <span class="s2">&quot;4096&quot;</span>
    end
    host.disksize.size <span class="o">=</span> <span class="s1">&#39;16GB&#39;</span>
    host.vm.synced_folder <span class="s2">&quot;./&quot;</span>, <span class="s2">&quot;/home/vagrant/docker-jupyter&quot;</span>, owner: <span class="s2">&quot;vagrant&quot;</span>, group: <span class="s2">&quot;vagrant&quot;</span>
  end

end
</pre></div>
<h3 id="Virtual-Machine-&#49373;&#49457;-&#48143;-&#51217;&#49549;">Virtual Machine &#49373;&#49457; &#48143; &#51217;&#49549;<a class="anchor-link" href="#Virtual-Machine-&#49373;&#49457;-&#48143;-&#51217;&#49549;">&#182;</a></h3><p>docker-jupyter 디렉토리 내에서 아래 명령어를 통해 Virtual Box 의 Virtual Machine 을 생성하고 접속하여 사용할수 있습니다.</p>

<pre><code>vagrant up
vagrant ssh v01</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
 

