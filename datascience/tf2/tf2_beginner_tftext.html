
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TF.Text &#8212; 데사견문록</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Subword Tokenization" href="tf2_beginner_subwords_tokenizer.html" />
    <link rel="prev" title="Unicode" href="tf2_beginner_unicode.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">데사견문록</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../readme.html">
   데이터사이언스견문록
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../readme.html">
   데이터사이언스
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../e2eds.html">
     End to End Data Science (E2EDS)
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../dataprep.html">
     Data Preperation
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../spark_dataframe_10mins.html">
       Spark DataFrame 10mins
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../pandas_10mins.html">
       Pandas 10mins
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../numpy_10mins.html">
       Numpy 10mins
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../random_seed.html">
       Random
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../pandas_data_description.html">
       Data Description
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../missing_value.html">
       Missing Value
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../pandas_descriptive_statistics.html">
       Descriptive Statistcs
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../model.html">
     Model
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="../outlier.html">
       Outlier
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../scipy_normality_test.html">
       Normality Test (Scipy)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../scipy_statistics_test.html">
       Statistics Test (Scipy)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../parallel_algorithm.html">
       One-Pass/Parallel Algorithm
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../sklearn/sklearn.html">
       Scikit-Learn
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
      <label for="toctree-checkbox-4">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_feature_selection.html">
         Feature Selection
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_feature_extraction.html">
         Feature Extraction
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_feature_transformation.html">
         Feature Transformation
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_split_train_test.html">
         Train/Valid/Test Dataset
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/imblearn_imbalanced_class.html">
         Imbalanced Class
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_model_persistence.html">
         Model Persistence
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_eval_regression.html">
         Regression Evaluation
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_linear_regression.html">
         Linear Regression
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_polynomial_regression.html">
         Polynomial Regression
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_sgd_regression.html">
         SGD Regression
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_svm_regression.html">
         SVM Regression
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_nearest_neighbor_regression.html">
         Nearest Neighbors Regression
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_ensemble_regression.html">
         Ensemble Regression
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_eval_classification.html">
         Classification Evaluation
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_logistic_regression.html">
         Logistic Regression
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_sgd_classification.html">
         SGD Classification
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_svm_classification.html">
         SVM Classification
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_nearest_neighbor_classification.html">
         Nearest Neighbors Classification
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_ensemble_classification.html">
         Ensemble Classification
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_eval_clustering.html">
         Clustering Evaluation
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_kmeans.html">
         K-Means
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_mean_shift.html">
         Mean Shift
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_spectral_clustering.html">
         Spectral Clustering
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_hyper_parameter_tunning.html">
         Hyper Parameter Tunning
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sklearn/sklearn_anomaly_detection.html">
         Anomaly Detection
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../surprise_collaborative_filtering.html">
       Collaborative Filtering (Surprise)
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../keras/keras.html">
       Keras
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
      <label for="toctree-checkbox-5">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../keras/keras_10mins.html">
         Keras 10mins
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../keras/keras_dnn_regression.html">
         DNN Regression
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../keras/keras_dnn_classification.html">
         DNN Classification
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../keras/keras_deepmf.html">
         Deep MF
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 current active has-children">
      <a class="reference internal" href="tf2.html">
       Tensorflow2
      </a>
      <input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
      <label for="toctree-checkbox-6">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul class="current">
       <li class="toctree-l4">
        <a class="reference internal" href="tf2_10mins.html">
         Tensorflow2 10mins
        </a>
       </li>
       <li class="toctree-l4 current active">
        <a class="reference internal" href="tf2_beginner.html">
         Beginner
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="tf2_advanced.html">
         Advanced
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../pytorch/pytorch.html">
       Pytorch
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../deploy.html">
     Deployment
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../streamlit.html">
       Streamlit
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../flask.html">
       Flask
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../dataplatform/readme.html">
   데이터플랫폼
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../dataplatform/infra.html">
     Infrastructure
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../dataplatform/infra_computer.html">
       Computer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../dataplatform/infra_network.html">
       Network
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../dataplatform/jupyter.html">
     Jupyter
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../dataplatform/jupyter_cloud.html">
       Jupyter (Cloud)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../dataplatform/jupyter_native_ubuntu.html">
       Jupyter (Ubuntu)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../dataplatform/jupyter_native_macos.html">
       Jupyter (macOS)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../dataplatform/jupyter_docker.html">
       Jupyter (Docker)
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../dataplatform/vagrant_virtualbox.html">
     Vagrant &amp; Virtualbox
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../dataplatform/vagrant_skp_single.html">
       vagrant_skp_single
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../dataplatform/ansible.html">
     Ansible
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../dataplatform/ansible_skp_ubuntu.html">
       ansible_skp_ubuntu
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../dataplatform/skp.html">
     St. Kilda Pier (SKP)
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
    <label for="toctree-checkbox-13">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../dataplatform/skp_n4e_vscode.html">
       Native Visual Studio Code
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../dataplatform/skp_n4e_jupyter.html">
       Native Jupyter
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../dataplatform/skp_d4r_jupyter.html">
       Docker Jupyter
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../dataplatform/skp_n4e_traefik.html">
       Native Traefik
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../dataplatform/gce-nested-vm.html">
     Google Computer Engine
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/datascience/tf2/tf2_beginner_tftext.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/comafire/comafire.github.io"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/comafire/comafire.github.io/issues/new?title=Issue%20on%20page%20%2Fdatascience/tf2/tf2_beginner_tftext.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/comafire/comafire.github.io/master?urlpath=tree/datascience/tf2/tf2_beginner_tftext.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#copyright-2018-the-tensorflow-authors">
   Copyright 2018 The TensorFlow Authors.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   TF.Text
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eager-execution">
   Eager Execution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#unicode">
   Unicode
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tokenization">
   Tokenization
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#whitespacetokenizer">
     WhitespaceTokenizer
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unicodescripttokenizer">
     UnicodeScriptTokenizer
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unicode-split">
     Unicode split
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#offsets">
     Offsets
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tf-data-example">
     TF.Data Example
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-text-ops">
   Other Text Ops
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wordshape">
     Wordshape
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#n-grams-sliding-window">
     N-grams &amp; Sliding Window
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="tf-text">
<h1>TF.Text<a class="headerlink" href="#tf-text" title="Permalink to this headline">¶</a></h1>
<p>TensorFlow2 공식 홈페이지에 나와 있는 코드들을 수행해 보면서 빠르게 TensorFlow2를 익혀 봅니다.</p>
<p><a class="reference external" href="https://www.tensorflow.org/tutorials/tensorflow_text/intro">https://www.tensorflow.org/tutorials/tensorflow_text/intro</a></p>
<div class="section" id="copyright-2018-the-tensorflow-authors">
<h2>Copyright 2018 The TensorFlow Authors.<a class="headerlink" href="#copyright-2018-the-tensorflow-authors" title="Permalink to this headline">¶</a></h2>
<p>Licensed under the Apache License, Version 2.0 (the “License”);</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); { display-mode: &quot;form&quot; }</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1"># https://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 설치</span>
<span class="o">!</span>pip install -q --upgrade pip
<span class="o">!</span>pip install -q tensorflow-text
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 경고 메시지 출력 끄기</span>
<span class="kn">import</span> <span class="nn">warnings</span> 
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>

<span class="c1"># 노트북 셀 표시를 브라우저 전체 폭 사용하기</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;style&gt;.container { width:100% !important; }&lt;/style&gt;&quot;</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">clear_output</span>

<span class="c1"># Matplotlib 설정</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39; # Macbook Retina Display를 위한 고해상도 설정
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn&#39;</span><span class="p">)</span> <span class="c1"># 스타일 설정</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span> <span class="c1"># 그림 크기</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span> <span class="c1"># 해상도</span>

<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">shutil</span><span class="o">,</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">collections</span><span class="o">,</span> <span class="nn">pathlib</span><span class="o">,</span> <span class="nn">re</span><span class="o">,</span> <span class="nn">string</span>

<span class="n">rseed</span> <span class="o">=</span> <span class="mi">22</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">rseed</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">rseed</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">formatter</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;float_kind&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:.5f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">})</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> 
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> 
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">float_format</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:,.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span>

<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="n">rseed</span><span class="p">)</span>
<span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">set_floatx</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span> <span class="c1"># keras default float type 설정</span>

<span class="kn">import</span> <span class="nn">tensorflow_hub</span> <span class="k">as</span> <span class="nn">tfhub</span>
<span class="kn">import</span> <span class="nn">tensorflow_datasets</span> <span class="k">as</span> <span class="nn">tfds</span>
<span class="kn">import</span> <span class="nn">tensorflow_text</span> <span class="k">as</span> <span class="nn">tftext</span>

<span class="kn">import</span> <span class="nn">kerastuner</span> <span class="k">as</span> <span class="nn">kt</span>

<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">import</span> <span class="nn">PIL</span>
<span class="kn">import</span> <span class="nn">PIL.Image</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;python ver=</span><span class="si">{</span><span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pandas ver=</span><span class="si">{</span><span class="n">pd</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;numpy ver=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tensorflow ver=</span><span class="si">{</span><span class="n">tf</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tensorflow execuring eagerly=</span><span class="si">{</span><span class="n">tf</span><span class="o">.</span><span class="n">executing_eagerly</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tensorflow GPU=</span><span class="si">{</span><span class="s1">&#39;True&#39;</span> <span class="k">if</span> <span class="n">tf</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">list_physical_devices</span><span class="p">(</span><span class="s1">&#39;GPU&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;False&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;keras tuner ver=</span><span class="si">{</span><span class="n">kt</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;senborn ver=</span><span class="si">{</span><span class="n">sns</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PIL ver=</span><span class="si">{</span><span class="n">PIL</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>.container { width:100% !important; }</style></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>python ver=3.7.6 (default, Nov 21 2020, 22:51:13) 
[Clang 12.0.0 (clang-1200.0.32.27)]
pandas ver=1.0.5
numpy ver=1.19.5
tensorflow ver=2.4.1
tensorflow execuring eagerly=True
tensorflow GPU=False
keras tuner ver=1.0.2
senborn ver=0.10.0
PIL ver=7.1.2
</pre></div>
</div>
</div>
</div>
<table class="tfo-notebook-buttons" align="left">
  <td>
    <a target="_blank" href="https://www.tensorflow.org/tutorials/tensorflow_text/intro"><img src="https://www.tensorflow.org/images/tf_logo_32px.png" />View on TensorFlow.org</a>
  </td>
  <td>
    <a target="_blank" href="https://colab.research.google.com/github/tensorflow/text/blob/master/examples/intro.ipynb"><img src="https://www.tensorflow.org/images/colab_logo_32px.png" />Run in Google Colab</a>
  </td>
  <td>
    <a target="_blank" href="https://github.com/tensorflow/text/blob/master/examples/intro.ipynb"><img src="https://www.tensorflow.org/images/GitHub-Mark-32px.png" />View source on GitHub</a>
  </td>
  <td>
    <a href="https://storage.googleapis.com/tensorflow_docs/text/examples/intro.ipynb"><img src="https://www.tensorflow.org/images/download_logo_32px.png" />Download notebook</a>
  </td>
</table>
*</div>
<hr class="docutils" />
<div class="section" id="id1">
<h2>TF.Text<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>TensorFlow Text provides a collection of text related classes and ops ready to use with TensorFlow 2.0. The library can perform the preprocessing regularly required by text-based models, and includes other features useful for sequence modeling not provided by core TensorFlow.</p>
<p>The benefit of using these ops in your text preprocessing is that they are done in the TensorFlow graph. You do not need to worry about tokenization in training being different than the tokenization at inference, or managing preprocessing scripts.</p>
</div>
<div class="section" id="eager-execution">
<h2>Eager Execution<a class="headerlink" href="#eager-execution" title="Permalink to this headline">¶</a></h2>
<p>TensorFlow Text requires TensorFlow 2.0, and is fully compatible with eager mode and graph mode.</p>
<hr class="docutils" />
<p>Note: On rare occassions, this import may fail looking for the TF library. Please reset the runtime and rerun the pip install -q below.</p>
</div>
<div class="section" id="unicode">
<h2>Unicode<a class="headerlink" href="#unicode" title="Permalink to this headline">¶</a></h2>
<p>Most ops expect that the strings are in UTF-8. If you’re using a different encoding, you can use the core tensorflow transcode op to transcode into UTF-8. You can also use the same op to coerce your string to structurally valid UTF-8 if your input could be invalid.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">docs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([</span><span class="sa">u</span><span class="s1">&#39;Everything not saved will be lost.&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;UTF-16-BE&#39;</span><span class="p">),</span> <span class="sa">u</span><span class="s1">&#39;Sad☹&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;UTF-16-BE&#39;</span><span class="p">)])</span>
<span class="n">utf8_docs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">unicode_transcode</span><span class="p">(</span><span class="n">docs</span><span class="p">,</span> <span class="n">input_encoding</span><span class="o">=</span><span class="s1">&#39;UTF-16-BE&#39;</span><span class="p">,</span> <span class="n">output_encoding</span><span class="o">=</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="tokenization">
<h2>Tokenization<a class="headerlink" href="#tokenization" title="Permalink to this headline">¶</a></h2>
<p>Tokenization is the process of breaking up a string into tokens. Commonly, these tokens are words, numbers, and/or punctuation.</p>
<p>The main interfaces are <code class="docutils literal notranslate"><span class="pre">Tokenizer</span></code> and <code class="docutils literal notranslate"><span class="pre">TokenizerWithOffsets</span></code> which each have a single method <code class="docutils literal notranslate"><span class="pre">tokenize</span></code> and <code class="docutils literal notranslate"><span class="pre">tokenize_with_offsets</span></code> respectively. There are multiple tokenizers available now. Each of these implement <code class="docutils literal notranslate"><span class="pre">TokenizerWithOffsets</span></code> (which extends <code class="docutils literal notranslate"><span class="pre">Tokenizer</span></code>) which includes an option for getting byte offsets into the original string. This allows the caller to know the bytes in the original string the token was created from.</p>
<p>All of the tokenizers return RaggedTensors with the inner-most dimension of tokens mapping to the original individual strings. As a result, the resulting shape’s rank is increased by one. Please review the ragged tensor guide if you are unfamiliar with them. <a class="reference external" href="https://www.tensorflow.org/guide/ragged_tensors">ragged_tensors</a></p>
<div class="section" id="whitespacetokenizer">
<h3>WhitespaceTokenizer<a class="headerlink" href="#whitespacetokenizer" title="Permalink to this headline">¶</a></h3>
<p>This is a basic tokenizer that splits UTF-8 strings on ICU defined whitespace characters (eg. space, tab, new line).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">tftext</span><span class="o">.</span><span class="n">WhitespaceTokenizer</span><span class="p">()</span>
<span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">tokenize</span><span class="p">([</span><span class="s1">&#39;everything not saved will be lost.&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;Sad☹&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tokens</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:tensorflow:From /Users/comafire/.pyenv/versions/3.7.6/envs/st-kilda-pier/lib/python3.7/site-packages/tensorflow/python/util/dispatch.py:201: batch_gather (from tensorflow.python.ops.array_ops) is deprecated and will be removed after 2017-10-25.
Instructions for updating:
`tf.batch_gather` is deprecated, please use `tf.gather` with `batch_dims=-1` instead.
[[b&#39;everything&#39;, b&#39;not&#39;, b&#39;saved&#39;, b&#39;will&#39;, b&#39;be&#39;, b&#39;lost.&#39;], [b&#39;Sad\xe2\x98\xb9&#39;]]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="unicodescripttokenizer">
<h3>UnicodeScriptTokenizer<a class="headerlink" href="#unicodescripttokenizer" title="Permalink to this headline">¶</a></h3>
<p>This tokenizer splits UTF-8 strings based on Unicode script boundaries. The script codes used correspond to International Components for Unicode (ICU) UScriptCode values. See: <a class="reference external" href="http://icu-project.org/apiref/icu4c/uscript_8h.html">http://icu-project.org/apiref/icu4c/uscript_8h.html</a></p>
<p>In practice, this is similar to the <code class="docutils literal notranslate"><span class="pre">WhitespaceTokenizer</span></code> with the most apparent difference being that it will split punctuation (USCRIPT_COMMON) from language texts (eg. USCRIPT_LATIN, USCRIPT_CYRILLIC, etc) while also separating language texts from each other.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">tftext</span><span class="o">.</span><span class="n">UnicodeScriptTokenizer</span><span class="p">()</span>
<span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">tokenize</span><span class="p">([</span><span class="s1">&#39;everything not saved will be lost.&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;Sad☹&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tokens</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[b&#39;everything&#39;, b&#39;not&#39;, b&#39;saved&#39;, b&#39;will&#39;, b&#39;be&#39;, b&#39;lost&#39;, b&#39;.&#39;], [b&#39;Sad&#39;, b&#39;\xe2\x98\xb9&#39;]]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="unicode-split">
<h3>Unicode split<a class="headerlink" href="#unicode-split" title="Permalink to this headline">¶</a></h3>
<p>When tokenizing languages without whitespace to segment words, it is common to just split by character, which can be accomplished using the <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/strings/unicode_split">unicode_split</a> op found in core.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tokens</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">unicode_split</span><span class="p">([</span><span class="sa">u</span><span class="s2">&quot;仅今年前&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)],</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tokens</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[b&#39;\xe4\xbb\x85&#39;, b&#39;\xe4\xbb\x8a&#39;, b&#39;\xe5\xb9\xb4&#39;, b&#39;\xe5\x89\x8d&#39;]]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="offsets">
<h3>Offsets<a class="headerlink" href="#offsets" title="Permalink to this headline">¶</a></h3>
<p>When tokenizing strings, it is often desired to know where in the original string the token originated from. For this reason, each tokenizer which implements <code class="docutils literal notranslate"><span class="pre">TokenizerWithOffsets</span></code> has a <em>tokenize_with_offsets</em> method that will return the byte offsets along with the tokens. The start_offsets lists the bytes in the original string each token starts at, and the end_offsets lists the bytes immediately after the point where each token ends.  Note: the start offsets are inclusive and the end offsets are exclusive.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">tftext</span><span class="o">.</span><span class="n">UnicodeScriptTokenizer</span><span class="p">()</span>
<span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">start_offsets</span><span class="p">,</span> <span class="n">end_offsets</span><span class="p">)</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">tokenize_with_offsets</span><span class="p">([</span><span class="s1">&#39;everything not saved will be lost.&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;Sad☹&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tokens</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">start_offsets</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">end_offsets</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[b&#39;everything&#39;, b&#39;not&#39;, b&#39;saved&#39;, b&#39;will&#39;, b&#39;be&#39;, b&#39;lost&#39;, b&#39;.&#39;], [b&#39;Sad&#39;, b&#39;\xe2\x98\xb9&#39;]]
[[0, 11, 15, 21, 26, 29, 33], [0, 3]]
[[10, 14, 20, 25, 28, 33, 34], [3, 6]]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="tf-data-example">
<h3>TF.Data Example<a class="headerlink" href="#tf-data-example" title="Permalink to this headline">¶</a></h3>
<p>Tokenizers work as expected with the tf.data API. A simple example is provided below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">docs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_tensor_slices</span><span class="p">([[</span><span class="s1">&#39;Never tell me the odds.&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;It&#39;s a trap!&quot;</span><span class="p">]])</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">tftext</span><span class="o">.</span><span class="n">WhitespaceTokenizer</span><span class="p">()</span>
<span class="n">tokenized_docs</span> <span class="o">=</span> <span class="n">docs</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">iterator</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">tokenized_docs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[b&#39;Never&#39;, b&#39;tell&#39;, b&#39;me&#39;, b&#39;the&#39;, b&#39;odds.&#39;]]
[[b&quot;It&#39;s&quot;, b&#39;a&#39;, b&#39;trap!&#39;]]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="other-text-ops">
<h2>Other Text Ops<a class="headerlink" href="#other-text-ops" title="Permalink to this headline">¶</a></h2>
<p>TF.Text packages other useful preprocessing ops. We will review a couple below.</p>
<div class="section" id="wordshape">
<h3>Wordshape<a class="headerlink" href="#wordshape" title="Permalink to this headline">¶</a></h3>
<p>A common feature used in some natural language understanding models is to see if the text string has a certain property. For example, a sentence breaking model might contain features which check for word capitalization or if a punctuation character is at the end of a string.</p>
<p>Wordshape defines a variety of useful regular expression based helper functions for matching various relevant patterns in your input text. Here are a few examples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">tftext</span><span class="o">.</span><span class="n">WhitespaceTokenizer</span><span class="p">()</span>
<span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">tokenize</span><span class="p">([</span><span class="s1">&#39;Everything not saved will be lost.&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;Sad☹&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)])</span>

<span class="c1"># Is capitalized?</span>
<span class="n">f1</span> <span class="o">=</span> <span class="n">tftext</span><span class="o">.</span><span class="n">wordshape</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">tftext</span><span class="o">.</span><span class="n">WordShape</span><span class="o">.</span><span class="n">HAS_TITLE_CASE</span><span class="p">)</span>
<span class="c1"># Are all letters uppercased?</span>
<span class="n">f2</span> <span class="o">=</span> <span class="n">tftext</span><span class="o">.</span><span class="n">wordshape</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">tftext</span><span class="o">.</span><span class="n">WordShape</span><span class="o">.</span><span class="n">IS_UPPERCASE</span><span class="p">)</span>
<span class="c1"># Does the token contain punctuation?</span>
<span class="n">f3</span> <span class="o">=</span> <span class="n">tftext</span><span class="o">.</span><span class="n">wordshape</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">tftext</span><span class="o">.</span><span class="n">WordShape</span><span class="o">.</span><span class="n">HAS_SOME_PUNCT_OR_SYMBOL</span><span class="p">)</span>
<span class="c1"># Is the token a number?</span>
<span class="n">f4</span> <span class="o">=</span> <span class="n">tftext</span><span class="o">.</span><span class="n">wordshape</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">tftext</span><span class="o">.</span><span class="n">WordShape</span><span class="o">.</span><span class="n">IS_NUMERIC_VALUE</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">f1</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f2</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f3</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f4</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[True, False, False, False, False, False], [True]]
[[False, False, False, False, False, False], [False]]
[[False, False, False, False, False, True], [True]]
[[False, False, False, False, False, False], [False]]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="n-grams-sliding-window">
<h3>N-grams &amp; Sliding Window<a class="headerlink" href="#n-grams-sliding-window" title="Permalink to this headline">¶</a></h3>
<p>N-grams are sequential words given a sliding window size of <em>n</em>. When combining the tokens, there are three reduction mechanisms supported. For text, you would want to use <code class="docutils literal notranslate"><span class="pre">Reduction.STRING_JOIN</span></code> which appends the strings to each other. The default separator character is a space, but this can be changed with the string_separater argument.</p>
<p>The other two reduction methods are most often used with numerical values, and these are <code class="docutils literal notranslate"><span class="pre">Reduction.SUM</span></code> and <code class="docutils literal notranslate"><span class="pre">Reduction.MEAN</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">tftext</span><span class="o">.</span><span class="n">WhitespaceTokenizer</span><span class="p">()</span>
<span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">tokenize</span><span class="p">([</span><span class="s1">&#39;Everything not saved will be lost.&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;Sad☹&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)])</span>

<span class="c1"># Ngrams, in this case bi-gram (n = 2)</span>
<span class="n">bigrams</span> <span class="o">=</span> <span class="n">tftext</span><span class="o">.</span><span class="n">ngrams</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">reduction_type</span><span class="o">=</span><span class="n">tftext</span><span class="o">.</span><span class="n">Reduction</span><span class="o">.</span><span class="n">STRING_JOIN</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">bigrams</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[b&#39;Everything not&#39;, b&#39;not saved&#39;, b&#39;saved will&#39;, b&#39;will be&#39;, b&#39;be lost.&#39;], []]
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./datascience/tf2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="tf2_beginner_unicode.html" title="previous page">Unicode</a>
    <a class='right-next' id="next-link" href="tf2_beginner_subwords_tokenizer.html" title="next page">Subword Tokenization</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By comafire<br/>
        
            &copy; Copyright 2015.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-81648003-1', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </body>
</html>