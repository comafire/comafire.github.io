<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Machine Learning - Model Persistence | Comafire's Lab</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://comafire.github.io/pages/ml-model-persistence/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><!-- Google Adsense --><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-0670106451680512",
          enable_page_level_ads: true
     });
</script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-81648003-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-81648003-1');
</script><meta name="author" content="comafire">
<meta property="og:site_name" content="Comafire's Lab">
<meta property="og:title" content="Machine Learning - Model Persistence">
<meta property="og:url" content="https://comafire.github.io/pages/ml-model-persistence/">
<meta property="og:description" content="Model Persistence¶머신러닝 모델을 학습시킨 후, 모델 재사용을 위해 저장하고 로드하는 방법을 알아봅니다.
Scikit-Learn¶Scikit-Learn 에서는 학습 후 모델을 저장하기 위해 joblib 모듈을 제공해 줍니다.






In [1]:

    
%matplotlib inline
import matplotlib.pyplot as">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2019-05-11T00:00:00+09:00">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-dark bg-dark
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="https://comafire.github.io/">

            <span id="blog-title">Comafire's Lab</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../index.html" class="nav-link">Home</a>
            </li>
<li class="nav-item dropdown">
<a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Pages</a>
            <div class="dropdown-menu">
                    <a href="../data-technology-platform" class="dropdown-item">Data Technology Platform</a>
                    <a href="../data-science-data-engineering" class="dropdown-item">Data Science - Data Engineering</a>
                    <a href="../data-science-machine-learning" class="dropdown-item">Data Science - Machine Learning</a>
                    <a href="../data-science-statistics" class="dropdown-item">Data Science - Statistics</a>
                    <a href="../data-technology-project" class="dropdown-item">Data Technology Project</a>
            </div>
            </li>
<li class="nav-item dropdown">
<a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Posts</a>
            <div class="dropdown-menu">
                    <a href="../../posts" class="dropdown-item">Posts</a>
                    <a href="../../archive.html" class="dropdown-item">Archive</a>
                    <a href="../../categories/" class="dropdown-item">Tag</a>
                    <a href="../../rss.xml" class="dropdown-item">RSS</a>
            </div>
                </li>
<li class="nav-item">
<a href="https://github.com/comafire" class="nav-link">GitHub</a>

                
            </li>
</ul>
<!-- Google custom search --><form method="get" action="https://www.google.com/search" class="navbar-form navbar-right" role="search">
<div class="input-group">
  <input type="text" name="q" class="form-control" placeholder="Search"><input type="hidden" name="sitesearch" value="https://comafire.github.io/"><div class="input-group-append">
    <button class="btn btn-primary" type="submit">Go</button>
  </div>
</div>

</form>
<!-- End of custom search -->


            <ul class="navbar-nav navbar-right">
<li class="nav-item">
    <a href="index.ipynb" id="sourcelink" class="nav-link">Source</a>
    </li>


                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
<article class="post-text storypage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Machine Learning - Model Persistence</a></h1>

        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Model-Persistence">Model Persistence<a class="anchor-link" href="#Model-Persistence">¶</a>
</h2>
<p>머신러닝 모델을 학습시킨 후, 모델 재사용을 위해 저장하고 로드하는 방법을 알아봅니다.</p>
<h3 id="Scikit-Learn">Scikit-Learn<a class="anchor-link" href="#Scikit-Learn">¶</a>
</h3>
<p>Scikit-Learn 에서는 학습 후 모델을 저장하기 위해 joblib 모듈을 제공해 줍니다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">model_selection</span><span class="p">,</span> <span class="n">linear_model</span><span class="p">,</span> <span class="n">metrics</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">joblib</span>

<span class="c1"># 데이터</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">np_data_xs</span><span class="p">,</span> <span class="n">np_data_ys</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">make_classification</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="c1"># 데이터 수</span>
    <span class="n">n_features</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="c1"># X feature 수</span>
    <span class="n">n_informative</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">n_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="c1"># Y class 수</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># 난수 발생용 Seed 값</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"data shape: np_data_xs=</span><span class="si">{}</span><span class="s2">, np_data_ys=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np_data_xs</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np_data_ys</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">np_train_xs</span><span class="p">,</span> <span class="n">np_test_xs</span><span class="p">,</span> <span class="n">np_train_ys</span><span class="p">,</span> <span class="n">np_test_ys</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">np_data_xs</span><span class="p">,</span> <span class="n">np_data_ys</span><span class="p">,</span> 
    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"train shape: np_train_xs=</span><span class="si">{}</span><span class="s2">, np_train_ys=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np_train_xs</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np_train_ys</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"test shape: np_test_xs=</span><span class="si">{}</span><span class="s2">, np_test_ys=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np_test_xs</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np_test_ys</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>

<span class="c1"># 모델</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">'sag'</span><span class="p">,</span> <span class="n">multi_class</span><span class="o">=</span><span class="s1">'multinomial'</span><span class="p">)</span>

<span class="c1"># 학습</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"model=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">np_train_xs</span><span class="p">,</span> <span class="n">np_train_ys</span><span class="p">)</span>

<span class="c1"># 평가</span>
<span class="n">np_pred_ys</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np_test_xs</span><span class="p">)</span>
<span class="n">cr</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">np_test_ys</span><span class="p">,</span> <span class="n">np_pred_ys</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"classification_report</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">cr</span><span class="p">)</span>

<span class="c1"># 모델 저장/로드</span>
<span class="n">path_model</span> <span class="o">=</span> <span class="s2">"/tmp/model.joblib"</span>
<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">path_model</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path_model</span><span class="p">)</span>

<span class="c1"># 재평가</span>
<span class="n">np_pred_ys</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np_test_xs</span><span class="p">)</span>
<span class="n">cr</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">np_test_ys</span><span class="p">,</span> <span class="n">np_pred_ys</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"classification_report</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">cr</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>data shape: np_data_xs=(100000, 10), np_data_ys=(100000,)
train shape: np_train_xs=(70000, 10), np_train_ys=(70000,)
test shape: np_test_xs=(30000, 10), np_test_ys=(30000,)
model=LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,
          intercept_scaling=1, max_iter=100, multi_class='multinomial',
          n_jobs=None, penalty='l2', random_state=None, solver='sag',
          tol=0.0001, verbose=0, warm_start=False)
classification_report
               precision    recall  f1-score   support

           0       0.77      0.79      0.78     10004
           1       0.77      0.72      0.74     10004
           2       0.88      0.91      0.89      9992

   micro avg       0.81      0.81      0.81     30000
   macro avg       0.81      0.81      0.81     30000
weighted avg       0.81      0.81      0.81     30000

classification_report
               precision    recall  f1-score   support

           0       0.77      0.79      0.78     10004
           1       0.77      0.72      0.74     10004
           2       0.88      0.91      0.89      9992

   micro avg       0.81      0.81      0.81     30000
   macro avg       0.81      0.81      0.81     30000
weighted avg       0.81      0.81      0.81     30000

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Keras">Keras<a class="anchor-link" href="#Keras">¶</a>
</h3>
<p>Keras에서 학습한 모델을 저장하고 불러오는 방법을 알아봅니다.</p>
<p>참조: <a href="https://keras.io/getting-started/faq/#how-can-i-save-a-keras-model">https://keras.io/getting-started/faq/#how-can-i-save-a-keras-model</a></p>
<h4 id="전체-모델-저장하기/불러오기-(architecture-+-weights-+-optimizer-state)">전체 모델 저장하기/불러오기 (architecture + weights + optimizer state)<a class="anchor-link" href="#%EC%A0%84%EC%B2%B4-%EB%AA%A8%EB%8D%B8-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0/%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0-(architecture-+-weights-+-optimizer-state)">¶</a>
</h4>
<p>모델을 하나의 HD5 파일 형식으로 하나의 파일에 저장하고 불러올 수 있습니다. 저장되는 정보는 아래와 같습니다.</p>
<ul>
<li>the architecture of the model, allowing to re-create the model</li>
<li>the weights of the model</li>
<li>the training configuration (loss, optimizer)</li>
<li>the state of the optimizer, allowing to resume training exactly where you left off.</li>
</ul>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>

<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">'my_model.h5'</span><span class="p">)</span>  <span class="c1"># creates a HDF5 file 'my_model.h5'</span>
<span class="k">del</span> <span class="n">model</span>  <span class="c1"># deletes the existing model</span>

<span class="c1"># returns a compiled model</span>
<span class="c1"># identical to the previous one</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s1">'my_model.h5'</span><span class="p">)</span>
</pre></div>
<h4 id="모델-구조만-저장하기/불러오기">모델 구조만 저장하기/불러오기<a class="anchor-link" href="#%EB%AA%A8%EB%8D%B8-%EA%B5%AC%EC%A1%B0%EB%A7%8C-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0/%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0">¶</a>
</h4>
<p>JSON 또는 YAML 형태로 모델을 저장하고 불러올 수 있습니다.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">model_from_json</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">model_from_yaml</span>

<span class="c1"># JSON</span>
<span class="n">json_string</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model_from_json</span><span class="p">(</span><span class="n">json_string</span><span class="p">)</span>

<span class="c1"># YAML</span>
<span class="n">yaml_string</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to_yaml</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model_from_yaml</span><span class="p">(</span><span class="n">yaml_string</span><span class="p">)</span>
</pre></div>
<h4 id="모델-가중치만-저장하기/불러오기">모델 가중치만 저장하기/불러오기<a class="anchor-link" href="#%EB%AA%A8%EB%8D%B8-%EA%B0%80%EC%A4%91%EC%B9%98%EB%A7%8C-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0/%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0">¶</a>
</h4>
<p>모델을 학습시킨 결과 가중치만 HDF5 형식으로 저장하고 불러올 수 있습니다. 저장된 가중치를 사용하기 위해서는 저장한 모델의 구조가 동일해야 합니다</p>
<div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">save_weights</span><span class="p">(</span><span class="s1">'my_model_weights.h5'</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="s1">'my_model_weights.h5'</span><span class="p">)</span>
</pre></div>
<p>Fine-tuning 또는 Transfer-learning 과 같이 불러온 가중치를 다른 모델에서 사용해야 할 경우에는 layer 의 이름을 통해 해당 layer 의 가중치만 불러오기도 가능합니다.</p>
<div class="highlight"><pre><span></span><span class="sd">"""</span>
<span class="sd">Assuming the original model looks like this:</span>
<span class="sd">    model = Sequential()</span>
<span class="sd">    model.add(Dense(2, input_dim=3, name='dense_1'))</span>
<span class="sd">    model.add(Dense(3, name='dense_2'))</span>
<span class="sd">    ...</span>
<span class="sd">    model.save_weights(fname)</span>
<span class="sd">"""</span>

<span class="c1"># new model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'dense_1'</span><span class="p">))</span>  <span class="c1"># will be loaded</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'new_dense'</span><span class="p">))</span>  <span class="c1"># will not be loaded</span>

<span class="c1"># load weights from first model; will only affect the first layer, dense_1.</span>
<span class="n">model</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">by_name</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
<h4 id="모델에-custom-layers-(or-other-custom-objects)-포함된-경우">모델에 custom layers (or other custom objects) 포함된 경우<a class="anchor-link" href="#%EB%AA%A8%EB%8D%B8%EC%97%90-custom-layers-(or-other-custom-objects)-%ED%8F%AC%ED%95%A8%EB%90%9C-%EA%B2%BD%EC%9A%B0">¶</a>
</h4>
<p>자신만의 모델을 위해 custom layer/object/function 를 작성한 경우, 모델을 불러올 때는 해당 정보를 모델에 넘겨 줘야 합니다.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>
<span class="c1"># Assuming your model includes instance of an "AttentionLayer" class</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s1">'my_model.h5'</span><span class="p">,</span> <span class="n">custom_objects</span><span class="o">=</span><span class="p">{</span><span class="s1">'AttentionLayer'</span><span class="p">:</span> <span class="n">AttentionLayer</span><span class="p">})</span>

<span class="kn">from</span> <span class="nn">keras.utils</span> <span class="kn">import</span> <span class="n">CustomObjectScope</span>
<span class="c1"># Alternatively, you can use a custom object scope:</span>
<span class="k">with</span> <span class="n">CustomObjectScope</span><span class="p">({</span><span class="s1">'AttentionLayer'</span><span class="p">:</span> <span class="n">AttentionLayer</span><span class="p">}):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s1">'my_model.h5'</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">model_from_json</span>
<span class="c1"># Custom objects handling works the same way for load_model, model_from_json, model_from_yaml:</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model_from_json</span><span class="p">(</span><span class="n">json_string</span><span class="p">,</span> <span class="n">custom_objects</span><span class="o">=</span><span class="p">{</span><span class="s1">'AttentionLayer'</span><span class="p">:</span> <span class="n">AttentionLayer</span><span class="p">})</span>
</pre></div>
<h4 id="모델-생성시-Class-를-사용한-경우">모델 생성시 Class 를 사용한 경우<a class="anchor-link" href="#%EB%AA%A8%EB%8D%B8-%EC%83%9D%EC%84%B1%EC%8B%9C-Class-%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%9C-%EA%B2%BD%EC%9A%B0">¶</a>
</h4>
<p>코드의 가독성을 위해 Keras 모델을 상속하여 모델 클래스를 만든 경우는 모델의 가중치 값만을 저장하고 불러올 수 있습니다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">preprocessing</span><span class="p">,</span> <span class="n">model_selection</span><span class="p">,</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">keras</span> <span class="k">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">layers</span><span class="p">,</span> <span class="n">optimizers</span><span class="p">,</span> <span class="n">utils</span>

<span class="c1"># 데이터</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">n_features</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">n_class</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">np_data_xs</span><span class="p">,</span> <span class="n">np_data_ys</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">make_classification</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="c1"># 데이터 수</span>
    <span class="n">n_features</span><span class="o">=</span><span class="n">n_features</span><span class="p">,</span> <span class="c1"># X feature 수</span>
    <span class="n">n_informative</span><span class="o">=</span><span class="n">n_class</span><span class="p">,</span>
    <span class="n">n_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="c1"># Y class 수</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># 난수 발생용 Seed 값</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"data shape: np_data_xs=</span><span class="si">{}</span><span class="s2">, np_data_ys=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np_data_xs</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np_data_ys</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">np_train_xs</span><span class="p">,</span> <span class="n">np_test_xs</span><span class="p">,</span> <span class="n">np_train_ys</span><span class="p">,</span> <span class="n">np_test_ys</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">np_data_xs</span><span class="p">,</span> <span class="n">np_data_ys</span><span class="p">,</span> 
    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"train shape: np_train_xs=</span><span class="si">{}</span><span class="s2">, np_train_ys=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np_train_xs</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np_train_ys</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"test shape: np_test_xs=</span><span class="si">{}</span><span class="s2">, np_test_ys=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np_test_xs</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np_test_ys</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>

<span class="c1"># 전처리</span>
<span class="n">scaler_xs</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">np_train_scale_xs</span> <span class="o">=</span> <span class="n">scaler_xs</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">np_train_xs</span><span class="p">)</span>
<span class="n">np_test_scale_xs</span> <span class="o">=</span> <span class="n">scaler_xs</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">np_test_xs</span><span class="p">)</span>

<span class="n">np_train_onehot_ys</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">np_utils</span><span class="o">.</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">np_train_ys</span><span class="p">,</span> <span class="n">n_class</span><span class="p">)</span>
<span class="n">np_test_onehot_ys</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">np_utils</span><span class="o">.</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">np_test_ys</span><span class="p">,</span> <span class="n">n_class</span><span class="p">)</span>

<span class="c1"># 모델</span>
<span class="k">class</span> <span class="nc">DnnClassifier</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_i</span><span class="p">,</span> <span class="n">n_hs</span><span class="p">,</span> <span class="n">n_o</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">n_i</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_i</span><span class="p">,)))</span>
        <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">n_h</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_hs</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">n_h</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">n_o</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">'softmax'</span><span class="p">))</span>
        <span class="n">sgd</span> <span class="o">=</span> <span class="n">optimizers</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">nesterov</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">sgd</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">'categorical_crossentropy'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">DnnClassifier</span><span class="p">(</span><span class="n">n_i</span> <span class="o">=</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">n_hs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span> <span class="n">n_o</span> <span class="o">=</span> <span class="n">n_class</span><span class="p">)</span>

<span class="c1"># 학습</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">model"</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">np_train_scale_xs</span><span class="p">,</span> <span class="n">np_train_onehot_ys</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">'loss'</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">'loss'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">'acc'</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">'acc'</span><span class="p">)</span>    
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>    

<span class="c1"># 평가</span>
<span class="n">np_pred_ys</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">np_test_scale_xs</span><span class="p">)</span>

<span class="n">acc</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">np_test_ys</span><span class="p">,</span> <span class="n">np_pred_ys</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"acc=</span><span class="si">{:.5f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">acc</span><span class="p">))</span>

<span class="n">cr</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">np_test_ys</span><span class="p">,</span> <span class="n">np_pred_ys</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"classification_report</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">cr</span><span class="p">)</span>

<span class="c1"># 모델 저장/로드</span>
<span class="n">model</span><span class="o">.</span><span class="n">save_weights</span><span class="p">(</span><span class="s1">'/tmp/my_model.h5'</span><span class="p">)</span>  <span class="c1"># creates a HDF5 file 'my_model.h5'</span>
<span class="k">del</span> <span class="n">model</span>  <span class="c1"># deletes the existing model</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">DnnClassifier</span><span class="p">(</span><span class="n">n_i</span> <span class="o">=</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">n_hs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span> <span class="n">n_o</span> <span class="o">=</span> <span class="n">n_class</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="s1">'/tmp/my_model.h5'</span><span class="p">)</span>

<span class="c1"># 재평가</span>
<span class="n">np_pred_ys</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">np_test_scale_xs</span><span class="p">)</span>

<span class="n">acc</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">np_test_ys</span><span class="p">,</span> <span class="n">np_pred_ys</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"acc=</span><span class="si">{:.5f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">acc</span><span class="p">))</span>

<span class="n">cr</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">np_test_ys</span><span class="p">,</span> <span class="n">np_pred_ys</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"classification_report</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">cr</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>Using TensorFlow backend.
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>data shape: np_data_xs=(10000, 10), np_data_ys=(10000,)
train shape: np_train_xs=(7000, 10), np_train_ys=(7000,)
test shape: np_test_xs=(3000, 10), np_test_ys=(3000,)

model
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 10)                110       
_________________________________________________________________
dense_2 (Dense)              (None, 16)                176       
_________________________________________________________________
dense_3 (Dense)              (None, 16)                272       
_________________________________________________________________
dense_4 (Dense)              (None, 3)                 51        
=================================================================
Total params: 609
Trainable params: 609
Non-trainable params: 0
_________________________________________________________________
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>acc=0.92933
classification_report
               precision    recall  f1-score   support

           0       0.92      0.91      0.92      1021
           1       0.93      0.91      0.92      1011
           2       0.94      0.96      0.95       968

   micro avg       0.93      0.93      0.93      3000
   macro avg       0.93      0.93      0.93      3000
weighted avg       0.93      0.93      0.93      3000

acc=0.92933
classification_report
               precision    recall  f1-score   support

           0       0.92      0.91      0.92      1021
           1       0.93      0.91      0.92      1011
           2       0.94      0.96      0.95       968

   micro avg       0.93      0.93      0.93      3000
   macro avg       0.93      0.93      0.93      3000
weighted avg       0.93      0.93      0.93      3000

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
</div>
    </div>
        <section class="comments"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="comafire",
            disqus_url="https://comafire.github.io/pages/ml-model-persistence/",
        disqus_title="Machine Learning - Model Persistence",
        disqus_identifier="cache/pages/ml-model-persistence.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha256-SDRP1VVYu+tgAGKhddBSl5+ezofHKZeI+OzxakbIe/Y=" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script></article><!--End of body content--><footer id="footer">
            Contents © 2019         <a href="mailto:comafire@gmail.com">comafire</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


        <script src="../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
