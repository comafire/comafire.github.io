
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Text Classification with Hub - Beginner (TF2) &#8212; 데사견문록</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Regression - Beginner (TF2)" href="tf2_beginner_regression.html" />
    <link rel="prev" title="Text Classification - Beginner (TF2)" href="tf2_beginner_text_classification.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">데사견문록</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../readme.html">
   데이터사이언스견문록
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../1day_trip/readme.html">
   당일치기 편
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/e2eds.html">
     End to End Data Science (E2EDS)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/infra.html">
     Infrastructure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/jupyter_cloud.html">
     Jupyter (Cloud)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/random_seed.html">
     Random
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/pandas_10mins.html">
     Pandas 10mins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/numpy_10mins.html">
     Numpy 10mins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/pandas_data_description.html">
     Data Description (Pandas)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/missing_value.html">
     Missing Value
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/pandas_descriptive_statistics.html">
     Descriptive Statistcs (Pandas)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/outlier.html">
     Outlier
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_feature_selection.html">
     Feature Selection (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_feature_extraction.html">
     Feature Extraction (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_feature_transformation.html">
     Feature Transformation (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/scipy_normality_test.html">
     Normality Test (Scipy)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/scipy_statistics_test.html">
     Statistics Test (Scipy)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/parallel_algorithm.html">
     One-Pass/Parallel Algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_split_train_test.html">
     Train/Valid/Test Dataset (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/imblearn_imbalanced_class.html">
     Imbalanced Class (Imblearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_model_persistence.html">
     Model Persistence (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_eval_regression.html">
     Regression Evaluation (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_linear_regression.html">
     Linear Regression (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_polynomial_regression.html">
     Polynomial Regression (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_sgd_regression.html">
     SGD Regression (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_svm_regression.html">
     SVM Regression (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_nearest_neighbor_regression.html">
     Nearest Neighbors Regression (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_ensemble_regression.html">
     Ensemble Regression (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_eval_classification.html">
     Classification Evaluation (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_logistic_regression.html">
     Logistic Regression (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_sgd_classification.html">
     SGD Classification (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_svm_classification.html">
     SVM Classification (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_nearest_neighbor_classification.html">
     Nearest Neighbors Classification (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_ensemble_classification.html">
     Ensemble Classification (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_eval_clustering.html">
     Clustering Evaluation (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_kmeans.html">
     K-Means (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_mean_shift.html">
     Mean Shift (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_spectral_clustering.html">
     Spectral Clustering (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_hyper_parameter_tunning.html">
     Hyper Parameter Tunning (Sklearn)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1day_trip/sklearn_anomaly_detection.html">
     Anomaly Detection (Sklearn)
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="readme.html">
   주말여행 편
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="jupyter_native_ubuntu.html">
     Jupyter (Ubuntu)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="jupyter_native_macos.html">
     Jupyter (macOS)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="spark_dataframe_10mins.html">
     Spark DataFrame 10mins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="keras_10mins.html">
     Keras 10mins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="keras_dnn_regression.html">
     DNN Regression (Keras)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="keras_dnn_classification.html">
     DNN Classification (Keras)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="surprise_collaborative_filtering.html">
     Collaborative Filtering (Surprise)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="keras_deepmf.html">
     Deep MF (Keras)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tf2_10mins.html">
     Tensorflow2 10mins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tf2_beginner_quickstart.html">
     Quickstart - Beginner (TF2)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tf2_beginner_image_classification.html">
     Image Classification - Beginner (TF2)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tf2_beginner_text_classification.html">
     Text Classification - Beginner (TF2)
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Text Classification with Hub - Beginner (TF2)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tf2_beginner_regression.html">
     Regression - Beginner (TF2)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tf2_beginner_overfit_underfit.html">
     Overfit &amp; Underfit - Beginner (TF2)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tf2_beginner_save_load.html">
     Save &amp; Load - Beginner (TF2)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tf2_beginner_keras_tuner.html">
     Keras Tuner - Beginner (TF2)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tf2_beginner_images.html">
     Images - Beginner (TF2)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tf2_beginner_csv.html">
     CSV - Beginner (TF2)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tf2_beginner_numpy.html">
     Numpy - Beginner (TF2)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tf2_beginner_pandas.html">
     Pandas - Beginner (TF2)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tf2_beginner_text.html">
     Text - Beginner (TF2)
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../5day_trip/readme.html">
   단기여행 편
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../5day_trip/infra.html">
     Infrastructure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../5day_trip/jupyter_docker.html">
     Jupyter (Docker)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../5day_trip/vagrant_virtualbox.html">
     Vagrant (Optional)
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../long_trip/readme.html">
   장기여행 편
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/2day_trip/tf2_beginner_hub_text_classification.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/comafire/comafire.github.io"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/comafire/comafire.github.io/issues/new?title=Issue%20on%20page%20%2F2day_trip/tf2_beginner_hub_text_classification.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/comafire/comafire.github.io/master?urlpath=tree/2day_trip/tf2_beginner_hub_text_classification.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#copyright-2019-the-tensorflow-authors">
   Copyright 2019 The TensorFlow Authors.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#text-classification-with-tensorflow-hub-movie-reviews">
   Text classification with TensorFlow Hub: Movie reviews
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#download-the-imdb-dataset">
   Download the IMDB dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#explore-the-data">
   Explore the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#build-the-model">
   Build the model
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loss-function-and-optimizer">
     Loss function and optimizer
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#train-the-model">
   Train the model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluate-the-model">
   Evaluate the model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#further-reading">
   Further reading
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="text-classification-with-hub-beginner-tf2">
<h1>Text Classification with Hub - Beginner (TF2)<a class="headerlink" href="#text-classification-with-hub-beginner-tf2" title="Permalink to this headline">¶</a></h1>
<p>TensorFlow2 공식 홈페이지에 나와 있는 코드들을 수행해 보면서 빠르게 TensorFlow2를 익혀 봅니다.</p>
<p><a class="reference external" href="https://www.tensorflow.org/tutorials/keras/text_classification_with_hub">https://www.tensorflow.org/tutorials/keras/text_classification_with_hub</a></p>
<div class="section" id="copyright-2019-the-tensorflow-authors">
<h2>Copyright 2019 The TensorFlow Authors.<a class="headerlink" href="#copyright-2019-the-tensorflow-authors" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1"># https://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title MIT License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2017 François Chollet</span>
<span class="c1">#</span>
<span class="c1"># Permission is hereby granted, free of charge, to any person obtaining a</span>
<span class="c1"># copy of this software and associated documentation files (the &quot;Software&quot;),</span>
<span class="c1"># to deal in the Software without restriction, including without limitation</span>
<span class="c1"># the rights to use, copy, modify, merge, publish, distribute, sublicense,</span>
<span class="c1"># and/or sell copies of the Software, and to permit persons to whom the</span>
<span class="c1"># Software is furnished to do so, subject to the following conditions:</span>
<span class="c1">#</span>
<span class="c1"># The above copyright notice and this permission notice shall be included in</span>
<span class="c1"># all copies or substantial portions of the Software.</span>
<span class="c1">#</span>
<span class="c1"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="c1"># IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="c1"># FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL</span>
<span class="c1"># THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="c1"># LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING</span>
<span class="c1"># FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER</span>
<span class="c1"># DEALINGS IN THE SOFTWARE.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 설치</span>
<span class="o">!</span>pip install -q --upgrade pip
<span class="o">!</span>pip install -q tensorflow-hub
<span class="o">!</span>pip install -q tensorflow-datasets
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 경고 메시지 출력 끄기</span>
<span class="kn">import</span> <span class="nn">warnings</span> 
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="c1"># 노트북 셀 표시를 브라우저 전체 폭 사용하기</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;style&gt;.container { width:100% !important; }&lt;/style&gt;&quot;</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">clear_output</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">rseed</span> <span class="o">=</span> <span class="mi">22</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">rseed</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">rseed</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">formatter</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;float_kind&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:.5f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">})</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> 
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> 
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">float_format</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:,.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span>

<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="n">rseed</span><span class="p">)</span>
<span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">set_floatx</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span> <span class="c1"># keras default float type 설정</span>

<span class="kn">import</span> <span class="nn">tensorflow_hub</span> <span class="k">as</span> <span class="nn">tfhub</span>
<span class="kn">import</span> <span class="nn">tensorflow_datasets</span> <span class="k">as</span> <span class="nn">tfds</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;python ver=</span><span class="si">{</span><span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pandas ver=</span><span class="si">{</span><span class="n">pd</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;numpy ver=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tensorflow ver=</span><span class="si">{</span><span class="n">tf</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tensorflow execuring eagerly=</span><span class="si">{</span><span class="n">tf</span><span class="o">.</span><span class="n">executing_eagerly</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tensorflow hub ver=</span><span class="si">{</span><span class="n">tfhub</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tensorflow GPU=</span><span class="si">{</span><span class="s1">&#39;True&#39;</span> <span class="k">if</span> <span class="n">tf</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">list_physical_devices</span><span class="p">(</span><span class="s1">&#39;GPU&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;False&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>.container { width:100% !important; }</style></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>python ver=3.7.6 (default, Nov 21 2020, 22:51:13) 
[Clang 12.0.0 (clang-1200.0.32.27)]
pandas ver=1.0.5
numpy ver=1.19.5
tensorflow ver=2.4.1
tensorflow execuring eagerly=True
tensorflow hub ver=0.11.0
tensorflow GPU=False
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="text-classification-with-tensorflow-hub-movie-reviews">
<h2>Text classification with TensorFlow Hub: Movie reviews<a class="headerlink" href="#text-classification-with-tensorflow-hub-movie-reviews" title="Permalink to this headline">¶</a></h2>
<table class="tfo-notebook-buttons" align="left">
  <td>
    <a target="_blank" href="https://www.tensorflow.org/tutorials/keras/text_classification_with_hub"><img src="https://www.tensorflow.org/images/tf_logo_32px.png" />View on TensorFlow.org</a>
  </td>
  <td>
    <a target="_blank" href="https://colab.research.google.com/github/tensorflow/docs/blob/master/site/en/tutorials/keras/text_classification_with_hub.ipynb"><img src="https://www.tensorflow.org/images/colab_logo_32px.png" />Run in Google Colab</a>
  </td>
  <td>
    <a target="_blank" href="https://github.com/tensorflow/docs/blob/master/site/en/tutorials/keras/text_classification_with_hub.ipynb"><img src="https://www.tensorflow.org/images/GitHub-Mark-32px.png" />View on GitHub</a>
  </td>
  <td>
    <a href="https://storage.googleapis.com/tensorflow_docs/docs/site/en/tutorials/keras/text_classification_with_hub.ipynb"><img src="https://www.tensorflow.org/images/download_logo_32px.png" />Download notebook</a>
  </td>
  <td>
    <a href="https://tfhub.dev/s?module-type=text-embedding"><img src="https://www.tensorflow.org/images/hub_logo_32px.png" />See TF Hub models</a>
  </td>
</table>
*<hr class="docutils" />
<p>This notebook classifies movie reviews as <em>positive</em> or <em>negative</em> using the text of the review. This is an example of <em>binary</em>—or two-class—classification, an important and widely applicable kind of machine learning problem.</p>
<p>The tutorial demonstrates the basic application of transfer learning with <a class="reference external" href="https://tfhub.dev">TensorFlow Hub</a> and Keras.</p>
<p>It uses the <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/datasets/imdb">IMDB dataset</a> that contains the text of 50,000 movie reviews from the <a class="reference external" href="https://www.imdb.com/">Internet Movie Database</a>. These are split into 25,000 reviews for training and 25,000 reviews for testing. The training and testing sets are <em>balanced</em>, meaning they contain an equal number of positive and negative reviews.</p>
<p>This notebook uses <a class="reference external" href="https://www.tensorflow.org/guide/keras"><code class="docutils literal notranslate"><span class="pre">tf.keras</span></code></a>, a high-level API to build and train models in TensorFlow, and <a class="reference external" href="https://www.tensorflow.org/hub"><code class="docutils literal notranslate"><span class="pre">tensorflow_hub</span></code></a>, a library for loading trained models from <a class="reference external" href="https://tfhub.dev">TFHub</a> in a single line of code. For a more advanced text classification tutorial using <code class="docutils literal notranslate"><span class="pre">tf.keras</span></code>, see the <a class="reference external" href="https://developers.google.com/machine-learning/guides/text-classification/">MLCC Text Classification Guide</a>.</p>
</div>
<div class="section" id="download-the-imdb-dataset">
<h2>Download the IMDB dataset<a class="headerlink" href="#download-the-imdb-dataset" title="Permalink to this headline">¶</a></h2>
<p>The IMDB dataset is available on <a class="reference external" href="https://www.tensorflow.org/datasets/catalog/imdb_reviews">imdb reviews</a> or on <a class="reference external" href="https://www.tensorflow.org/datasets">TensorFlow datasets</a>. The following code downloads the IMDB dataset to your machine (or the colab runtime):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Split the training set into 60% and 40% to end up with 15,000 examples</span>
<span class="c1"># for training, 10,000 examples for validation and 25,000 examples for testing.</span>
<span class="n">train_data</span><span class="p">,</span> <span class="n">validation_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> <span class="n">tfds</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;imdb_reviews&quot;</span><span class="p">,</span> 
    <span class="n">split</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;train[:60%]&#39;</span><span class="p">,</span> <span class="s1">&#39;train[60%:]&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">),</span>
    <span class="n">as_supervised</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="explore-the-data">
<h2>Explore the data<a class="headerlink" href="#explore-the-data" title="Permalink to this headline">¶</a></h2>
<p>Let’s take a moment to understand the format of the data. Each example is a sentence representing the movie review and a corresponding label. The sentence is not preprocessed in any way. The label is an integer value of either 0 or 1, where 0 is a negative review, and 1 is a positive review.</p>
<p>Let’s print first 3 examples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_examples_batch</span><span class="p">,</span> <span class="n">train_labels_batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">train_data</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="n">train_examples_batch</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;tf.Tensor: shape=(3,), dtype=string, numpy=
array([b&quot;This was an absolutely terrible movie. Don&#39;t be lured in by Christopher Walken or Michael Ironside. Both are great actors, but this must simply be their worst role in history. Even their great acting could not redeem this movie&#39;s ridiculous storyline. This movie is an early nineties US propaganda piece. The most pathetic scenes were those when the Columbian rebels were making their cases for revolutions. Maria Conchita Alonso appeared phony, and her pseudo-love affair with Walken was nothing but a pathetic emotional plug in a movie that was devoid of any real meaning. I am disappointed that there are movies like this, ruining actor&#39;s like Christopher Walken&#39;s good name. I could barely sit through it.&quot;,
       b&#39;I have been known to fall asleep during films, but this is usually due to a combination of things including, really tired, being warm and comfortable on the sette and having just eaten a lot. However on this occasion I fell asleep because the film was rubbish. The plot development was constant. Constantly slow and boring. Things seemed to happen, but with no explanation of what was causing them or why. I admit, I may have missed part of the film, but i watched the majority of it and everything just seemed to happen of its own accord without any real concern for anything else. I cant recommend this film at all.&#39;,
       b&#39;Mann photographs the Alberta Rocky Mountains in a superb fashion, and Jimmy Stewart and Walter Brennan give enjoyable performances as they always seem to do. &lt;br /&gt;&lt;br /&gt;But come on Hollywood - a Mountie telling the people of Dawson City, Yukon to elect themselves a marshal (yes a marshal!) and to enforce the law themselves, then gunfighters battling it out on the streets for control of the town? &lt;br /&gt;&lt;br /&gt;Nothing even remotely resembling that happened on the Canadian side of the border during the Klondike gold rush. Mr. Mann and company appear to have mistaken Dawson City for Deadwood, the Canadian North for the American Wild West.&lt;br /&gt;&lt;br /&gt;Canadian viewers be prepared for a Reefer Madness type of enjoyable howl with this ludicrous plot, or, to shake your head in disgust.&#39;],
      dtype=object)&gt;
</pre></div>
</div>
</div>
</div>
<p>Let’s also print the first 3 labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_labels_batch</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;tf.Tensor: shape=(3,), dtype=int64, numpy=array([0, 0, 0])&gt;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="build-the-model">
<h2>Build the model<a class="headerlink" href="#build-the-model" title="Permalink to this headline">¶</a></h2>
<p>The neural network is created by stacking layers—this requires three main architectural decisions:</p>
<ul class="simple">
<li><p>How to represent the text?</p></li>
<li><p>How many layers to use in the model?</p></li>
<li><p>How many <em>hidden units</em> to use for each layer?</p></li>
</ul>
<p>In this example, the input data consists of sentences. The labels to predict are either 0 or 1.</p>
<p>One way to represent the text is to convert sentences into embeddings vectors. Use a pre-trained text embedding as the first layer, which will have three advantages:</p>
<ul class="simple">
<li><p>You don’t have to worry about text preprocessing,</p></li>
<li><p>Benefit from transfer learning,</p></li>
<li><p>the embedding has a fixed size, so it’s simpler to process.</p></li>
</ul>
<p>For this example you use a <strong>pre-trained text embedding model</strong> from <a class="reference external" href="https://tfhub.dev">TensorFlow Hub</a> called <a class="reference external" href="https://tfhub.dev/google/nnlm-en-dim50/2">google/nnlm-en-dim50/2</a>.</p>
<p>There are many other pre-trained text embeddings from TFHub that can be used in this tutorial:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://tfhub.dev/google/nnlm-en-dim128/2">google/nnlm-en-dim128/2</a> - trained with the same NNLM architecture on the same data as <a class="reference external" href="https://tfhub.dev/google/nnlm-en-dim50/2">google/nnlm-en-dim50/2</a>, but with a larger embedding dimension. Larger dimensional embeddings can improve on your task but it may take longer to train your model.</p></li>
<li><p><a class="reference external" href="https://tfhub.dev/google/nnlm-en-dim128-with-normalization/2">google/nnlm-en-dim128-with-normalization/2</a> - the same as <a class="reference external" href="https://tfhub.dev/google/nnlm-en-dim128/2">google/nnlm-en-dim128/2</a>, but with additional text normalization such as removing punctuation. This can help if the text in your task contains additional characters or punctuation.</p></li>
<li><p><a class="reference external" href="https://tfhub.dev/google/universal-sentence-encoder/4">google/universal-sentence-encoder/4</a> - a much larger model yielding 512 dimensional embeddings trained with a deep averaging network (DAN) encoder.</p></li>
</ul>
<p>And many more! Find more <a class="reference external" href="https://tfhub.dev/s?module-type=text-embedding">text embedding models</a> on TFHub.</p>
<p>Let’s first create a Keras layer that uses a TensorFlow Hub model to embed the sentences, and try it out on a couple of input examples. Note that no matter the length of the input text, the output shape of the embeddings is: <code class="docutils literal notranslate"><span class="pre">(num_examples,</span> <span class="pre">embedding_dimension)</span></code>.</p>
<blockquote>
<div><p>이번 모델에서는 <a class="reference external" href="https://www.tensorflow.org/hub?hl=ko">텐서플로 허브</a>에 있는 사전 학습된 텍스트 임베딩 모델을 모델에 포함시켜 전이 학습 (Transfr Learning)을 진행합니다.
문장을 임베딩(embedding) 벡터로 바꾸고 첫 번째 레이어로 사전 훈련(pre-trained)된 텍스트 임베딩을 사용하며, 이 방법에는 3가지 장점이 있습니다.</p>
</div></blockquote>
<blockquote>
<div><ul class="simple">
<li><p>텍스트 전처리에 대해 신경 쓸 필요가 없습니다.</p></li>
<li><p>전이 학습(Transfer Learning)의 장점을 이용합니다.</p></li>
<li><p>임베딩은 고정 크기이기 때문에 처리 과정이 단순해집니다.</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><p>용어: OOV 버킷(Out of Vocabulary Bucket: 어휘 사전에 없는 단어를 해싱하여 같은 단어끼리 묶어 놓음)</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">embedding</span> <span class="o">=</span> <span class="s2">&quot;https://tfhub.dev/google/nnlm-en-dim50/2&quot;</span>
<span class="n">hub_layer</span> <span class="o">=</span> <span class="n">tfhub</span><span class="o">.</span><span class="n">KerasLayer</span><span class="p">(</span><span class="n">embedding</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">[],</span> 
                           <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">string</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hub_layer</span><span class="p">(</span><span class="n">train_examples_batch</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;tf.Tensor: shape=(3, 50), dtype=float32, numpy=
array([[0.54232, -0.01190, 0.06338, 0.06863, -0.16777, -0.10581, 0.16865,
        -0.04999, -0.31148, 0.07910, 0.15442, 0.01489, 0.03930, 0.19773,
        -0.12215, -0.04121, -0.27041, -0.21922, 0.26518, -0.80739,
        0.25834, -0.31004, 0.28683, 0.19434, -0.29036, 0.03863, -0.78444,
        -0.04793, 0.41103, -0.36389, -0.58035, 0.30269, 0.36309,
        -0.15227, -0.44392, 0.19463, 0.19528, 0.05666, 0.28907, -0.28468,
        -0.00531, 0.05719, -0.32013, -0.04419, -0.08551, -0.55847,
        -0.23336, -0.20783, -0.03543, -0.17533],
       [0.56339, -0.12340, -0.10863, 0.77534, -0.07667, -0.15752,
        0.01872, -0.08170, -0.35219, 0.46373, -0.08493, 0.07167,
        -0.00671, 0.12686, -0.19327, -0.52626, -0.32958, 0.14395,
        0.09044, -0.54176, 0.02468, -0.15457, 0.68333, 0.09068, -0.45327,
        0.23180, -0.86157, 0.34480, 0.12838, -0.58759, -0.40712, 0.23061,
        0.48427, -0.27128, -0.53809, 0.47016, 0.22573, -0.00831, 0.28462,
        -0.30498, 0.04400, 0.25026, 0.14867, 0.40717, -0.15422, -0.06878,
        -0.40826, -0.31492, 0.09284, -0.20183],
       [0.74562, 0.21257, 0.14400, 0.52339, 0.11032, 0.00903, -0.36678,
        -0.08938, -0.24166, 0.33385, -0.11195, -0.01460, -0.00716,
        0.19563, 0.00685, -0.24887, -0.42796, 0.18620, -0.05241,
        -0.66462, 0.13449, -0.22205, 0.08633, 0.43685, 0.29727, 0.36141,
        -0.71969, 0.05291, -0.14316, -0.15734, -0.15056, -0.05988,
        -0.08179, -0.15569, -0.09304, -0.18971, 0.07621, -0.02542,
        -0.27135, -0.33927, -0.10296, -0.27275, -0.34078, 0.20083,
        -0.26645, 0.00655, -0.05141, -0.04262, -0.45414, 0.20024]],
      dtype=float32)&gt;
</pre></div>
</div>
</div>
</div>
<p>Let’s now build the full model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hub_layer</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model: &quot;sequential&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
keras_layer (KerasLayer)     (None, 50)                48190600  
_________________________________________________________________
dense (Dense)                (None, 16)                816       
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 17        
=================================================================
Total params: 48,191,433
Trainable params: 48,191,433
Non-trainable params: 0
_________________________________________________________________
</pre></div>
</div>
</div>
</div>
<p>The layers are stacked sequentially to build the classifier:</p>
<ol class="simple">
<li><p>The first layer is a TensorFlow Hub layer. This layer uses a pre-trained Saved Model to map a sentence into its embedding vector. The pre-trained text embedding model that you are using (<a class="reference external" href="https://tfhub.dev/google/nnlm-en-dim50/2">google/nnlm-en-dim50/2</a>) splits the sentence into tokens, embeds each token and then combines the embedding. The resulting dimensions are: <code class="docutils literal notranslate"><span class="pre">(num_examples,</span> <span class="pre">embedding_dimension)</span></code>. For this NNLM model, the <code class="docutils literal notranslate"><span class="pre">embedding_dimension</span></code> is 50.</p></li>
<li><p>This fixed-length output vector is piped through a fully-connected (<code class="docutils literal notranslate"><span class="pre">Dense</span></code>) layer with 16 hidden units.</p></li>
<li><p>The last layer is densely connected with a single output node.</p></li>
</ol>
<p>Let’s compile the model.</p>
<div class="section" id="loss-function-and-optimizer">
<h3>Loss function and optimizer<a class="headerlink" href="#loss-function-and-optimizer" title="Permalink to this headline">¶</a></h3>
<p>A model needs a loss function and an optimizer for training. Since this is a binary classification problem and the model outputs logits (a single-unit layer with a linear activation), you’ll use the <code class="docutils literal notranslate"><span class="pre">binary_crossentropy</span></code> loss function.</p>
<p>This isn’t the only choice for a loss function, you could, for instance, choose <code class="docutils literal notranslate"><span class="pre">mean_squared_error</span></code>. But, generally, <code class="docutils literal notranslate"><span class="pre">binary_crossentropy</span></code> is better for dealing with probabilities—it measures the “distance” between probability distributions, or in our case, between the ground-truth distribution and the predictions.</p>
<p>Later, when you are exploring regression problems (say, to predict the price of a house), you’ll see how to use another loss function called mean squared error.</p>
<p>Now, configure the model to use an optimizer and a loss function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span>
              <span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">BinaryCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="train-the-model">
<h2>Train the model<a class="headerlink" href="#train-the-model" title="Permalink to this headline">¶</a></h2>
<p>Train the model for 10 epochs in mini-batches of 512 samples. This is 10 iterations over all samples in the <code class="docutils literal notranslate"><span class="pre">x_train</span></code> and <code class="docutils literal notranslate"><span class="pre">y_train</span></code> tensors. While training, monitor the model’s loss and accuracy on the 10,000 samples from the validation set:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span>
                    <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                    <span class="n">validation_data</span><span class="o">=</span><span class="n">validation_data</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span>
                    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/10
30/30 [==============================] - 13s 396ms/step - loss: 0.7108 - accuracy: 0.4847 - val_loss: 0.6345 - val_accuracy: 0.5705
Epoch 2/10
30/30 [==============================] - 11s 373ms/step - loss: 0.6007 - accuracy: 0.6200 - val_loss: 0.5362 - val_accuracy: 0.6971
Epoch 3/10
30/30 [==============================] - 11s 374ms/step - loss: 0.4767 - accuracy: 0.7669 - val_loss: 0.4319 - val_accuracy: 0.8060
Epoch 4/10
30/30 [==============================] - 11s 376ms/step - loss: 0.3506 - accuracy: 0.8624 - val_loss: 0.3643 - val_accuracy: 0.8408
Epoch 5/10
30/30 [==============================] - 11s 374ms/step - loss: 0.2535 - accuracy: 0.9102 - val_loss: 0.3290 - val_accuracy: 0.8550
Epoch 6/10
30/30 [==============================] - 11s 375ms/step - loss: 0.1856 - accuracy: 0.9402 - val_loss: 0.3107 - val_accuracy: 0.8666
Epoch 7/10
30/30 [==============================] - 11s 372ms/step - loss: 0.1251 - accuracy: 0.9636 - val_loss: 0.3131 - val_accuracy: 0.8698
Epoch 8/10
30/30 [==============================] - 11s 374ms/step - loss: 0.0861 - accuracy: 0.9791 - val_loss: 0.3147 - val_accuracy: 0.8647
Epoch 9/10
30/30 [==============================] - 11s 377ms/step - loss: 0.0638 - accuracy: 0.9854 - val_loss: 0.3258 - val_accuracy: 0.8695
Epoch 10/10
30/30 [==============================] - 11s 375ms/step - loss: 0.0447 - accuracy: 0.9931 - val_loss: 0.3355 - val_accuracy: 0.8684
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="evaluate-the-model">
<h2>Evaluate the model<a class="headerlink" href="#evaluate-the-model" title="Permalink to this headline">¶</a></h2>
<p>And let’s see how the model performs. Two values will be returned. Loss (a number which represents our error, lower values are better), and accuracy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">metrics_names</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">: </span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>49/49 - 1s - loss: 0.3604 - accuracy: 0.8516
loss: 0.360
accuracy: 0.852
</pre></div>
</div>
</div>
</div>
<p>This fairly naive approach achieves an accuracy of about 87%. With more advanced approaches, the model should get closer to 95%.</p>
</div>
<div class="section" id="further-reading">
<h2>Further reading<a class="headerlink" href="#further-reading" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>For a more general way to work with string inputs and for a more detailed analysis of the progress of accuracy and loss during training, see the <span class="xref myst">Text classification with preprocessed text</span> tutorial.</p></li>
<li><p>Try out more <a class="reference external" href="https://www.tensorflow.org/hub/tutorials#text-related-tutorials">text-related tutorials</a> using trained models from TFHub.</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./2day_trip"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="tf2_beginner_text_classification.html" title="previous page">Text Classification - Beginner (TF2)</a>
    <a class='right-next' id="next-link" href="tf2_beginner_regression.html" title="next page">Regression - Beginner (TF2)</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By comafire<br/>
        
            &copy; Copyright 2015.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-81648003-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>