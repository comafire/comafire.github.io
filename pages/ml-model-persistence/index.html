<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Machine Learning - Model Persistence | Comafire's Lab</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://comafire.github.io/pages/ml-model-persistence/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><!-- Google Adsense --><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-0670106451680512",
          enable_page_level_ads: true
     });
</script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-81648003-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-81648003-1');
</script><meta name="author" content="comafire">
<meta property="og:site_name" content="Comafire's Lab">
<meta property="og:title" content="Machine Learning - Model Persistence">
<meta property="og:url" content="https://comafire.github.io/pages/ml-model-persistence/">
<meta property="og:description" content="Model Persistence¶머신러닝 모델을 학습시킨 후, 모델 재사용을 위해 저장하고 로드하는 방법을 알아봅니다.
Scikit-Learn¶Scikit-Learn 에서는 학습 후 모델을 저장하기 위해 joblib 모듈을 제공해 줍니다.






In [1]:

    
%matplotlib inline
import matplotlib.pyplot as">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2019-05-11T00:00:00+09:00">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-dark bg-dark
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="https://comafire.github.io/">

            <span id="blog-title">Comafire's Lab</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../index.html" class="nav-link">Home</a>
            </li>
<li class="nav-item dropdown">
<a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Pages</a>
            <div class="dropdown-menu">
                    <a href="../data-technology-platform" class="dropdown-item">Data Technology Platform</a>
                    <a href="../data-science-data-engineering" class="dropdown-item">Data Science - Data Engineering</a>
                    <a href="../data-science-machine-learning" class="dropdown-item">Data Science - Machine Learning</a>
                    <a href="../data-science-statistics" class="dropdown-item">Data Science - Statistics</a>
                    <a href="../data-technology-project" class="dropdown-item">Data Technology Project</a>
            </div>
            </li>
<li class="nav-item dropdown">
<a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Posts</a>
            <div class="dropdown-menu">
                    <a href="../../posts" class="dropdown-item">Posts</a>
                    <a href="../../archive.html" class="dropdown-item">Archive</a>
                    <a href="../../categories/" class="dropdown-item">Tag</a>
                    <a href="../../rss.xml" class="dropdown-item">RSS</a>
            </div>
                </li>
<li class="nav-item">
<a href="https://github.com/comafire" class="nav-link">GitHub</a>

                
            </li>
</ul>
<!-- Google custom search --><form method="get" action="https://www.google.com/search" class="navbar-form navbar-right" role="search">
<div class="input-group">
  <input type="text" name="q" class="form-control" placeholder="Search"><input type="hidden" name="sitesearch" value="https://comafire.github.io/"><div class="input-group-append">
    <button class="btn btn-primary" type="submit">Go</button>
  </div>
</div>

</form>
<!-- End of custom search -->


            <ul class="navbar-nav navbar-right">
<li class="nav-item">
    <a href="index.ipynb" id="sourcelink" class="nav-link">Source</a>
    </li>


                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
<article class="post-text storypage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Machine Learning - Model Persistence</a></h1>

        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Model-Persistence">Model Persistence<a class="anchor-link" href="#Model-Persistence">¶</a>
</h2>
<p>머신러닝 모델을 학습시킨 후, 모델 재사용을 위해 저장하고 로드하는 방법을 알아봅니다.</p>
<h3 id="Scikit-Learn">Scikit-Learn<a class="anchor-link" href="#Scikit-Learn">¶</a>
</h3>
<p>Scikit-Learn 에서는 학습 후 모델을 저장하기 위해 joblib 모듈을 제공해 줍니다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">model_selection</span><span class="p">,</span> <span class="n">linear_model</span><span class="p">,</span> <span class="n">metrics</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">joblib</span>

<span class="c1"># 데이터</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">np_data_xs</span><span class="p">,</span> <span class="n">np_data_ys</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">make_classification</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="c1"># 데이터 수</span>
    <span class="n">n_features</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="c1"># X feature 수</span>
    <span class="n">n_informative</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">n_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="c1"># Y class 수</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># 난수 발생용 Seed 값</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"data shape: np_data_xs=</span><span class="si">{}</span><span class="s2">, np_data_ys=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np_data_xs</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np_data_ys</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">np_train_xs</span><span class="p">,</span> <span class="n">np_test_xs</span><span class="p">,</span> <span class="n">np_train_ys</span><span class="p">,</span> <span class="n">np_test_ys</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">np_data_xs</span><span class="p">,</span> <span class="n">np_data_ys</span><span class="p">,</span> 
    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"train shape: np_train_xs=</span><span class="si">{}</span><span class="s2">, np_train_ys=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np_train_xs</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np_train_ys</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"test shape: np_test_xs=</span><span class="si">{}</span><span class="s2">, np_test_ys=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np_test_xs</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np_test_ys</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>

<span class="c1"># 모델</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">'sag'</span><span class="p">,</span> <span class="n">multi_class</span><span class="o">=</span><span class="s1">'multinomial'</span><span class="p">)</span>

<span class="c1"># 학습</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"model=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">np_train_xs</span><span class="p">,</span> <span class="n">np_train_ys</span><span class="p">)</span>

<span class="c1"># 평가</span>
<span class="n">np_pred_ys</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np_test_xs</span><span class="p">)</span>
<span class="n">cr</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">np_test_ys</span><span class="p">,</span> <span class="n">np_pred_ys</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"classification_report</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">cr</span><span class="p">)</span>

<span class="c1"># 모델 저장/로드</span>
<span class="n">path_model</span> <span class="o">=</span> <span class="s2">"/tmp/model.joblib"</span>
<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">path_model</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path_model</span><span class="p">)</span>

<span class="c1"># 재평가</span>
<span class="n">np_pred_ys</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np_test_xs</span><span class="p">)</span>
<span class="n">cr</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">np_test_ys</span><span class="p">,</span> <span class="n">np_pred_ys</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"classification_report</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">cr</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>data shape: np_data_xs=(100000, 10), np_data_ys=(100000,)
train shape: np_train_xs=(70000, 10), np_train_ys=(70000,)
test shape: np_test_xs=(30000, 10), np_test_ys=(30000,)
model=LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,
          intercept_scaling=1, max_iter=100, multi_class='multinomial',
          n_jobs=None, penalty='l2', random_state=None, solver='sag',
          tol=0.0001, verbose=0, warm_start=False)
classification_report
               precision    recall  f1-score   support

           0       0.77      0.79      0.78     10004
           1       0.77      0.72      0.74     10004
           2       0.88      0.91      0.89      9992

   micro avg       0.81      0.81      0.81     30000
   macro avg       0.81      0.81      0.81     30000
weighted avg       0.81      0.81      0.81     30000

classification_report
               precision    recall  f1-score   support

           0       0.77      0.79      0.78     10004
           1       0.77      0.72      0.74     10004
           2       0.88      0.91      0.89      9992

   micro avg       0.81      0.81      0.81     30000
   macro avg       0.81      0.81      0.81     30000
weighted avg       0.81      0.81      0.81     30000

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Keras">Keras<a class="anchor-link" href="#Keras">¶</a>
</h3>
<p>Keras에서 학습한 모델을 저장하고 불러오는 방법을 알아봅니다.</p>
<p>참조: <a href="https://keras.io/getting-started/faq/#how-can-i-save-a-keras-model">https://keras.io/getting-started/faq/#how-can-i-save-a-keras-model</a></p>
<h4 id="전체-모델-저장하기/불러오기-(architecture-+-weights-+-optimizer-state)">전체 모델 저장하기/불러오기 (architecture + weights + optimizer state)<a class="anchor-link" href="#%EC%A0%84%EC%B2%B4-%EB%AA%A8%EB%8D%B8-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0/%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0-(architecture-+-weights-+-optimizer-state)">¶</a>
</h4>
<p>모델을 하나의 HD5 파일 형식으로 하나의 파일에 저장하고 불러올 수 있습니다. 저장되는 정보는 아래와 같습니다.</p>
<ul>
<li>the architecture of the model, allowing to re-create the model</li>
<li>the weights of the model</li>
<li>the training configuration (loss, optimizer)</li>
<li>the state of the optimizer, allowing to resume training exactly where you left off.</li>
</ul>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>

<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">'my_model.h5'</span><span class="p">)</span>  <span class="c1"># creates a HDF5 file 'my_model.h5'</span>
<span class="k">del</span> <span class="n">model</span>  <span class="c1"># deletes the existing model</span>

<span class="c1"># returns a compiled model</span>
<span class="c1"># identical to the previous one</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s1">'my_model.h5'</span><span class="p">)</span>
</pre></div>
<p>전체 모델을 저장하고/불러오기 위해서는 Keras의 기본 모델을 이용하여 모델을 생성해야 합니다. 코드의 가독성을 위해 Keras 모델을 상속하여 모델 클래스를 만들어 사용하는 경우는 모델의 가중치 값만을 저장하고 불러올 수 있습니다. 복잡한 모델의 경우는 모델의 구조를 저장하는 것이 유리하기때문에 기본 Keras 클래스를 통해 모델을 생성하는 것을 추천합니다.</p>
<h4 id="모델-구조만-저장하기/불러오기">모델 구조만 저장하기/불러오기<a class="anchor-link" href="#%EB%AA%A8%EB%8D%B8-%EA%B5%AC%EC%A1%B0%EB%A7%8C-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0/%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0">¶</a>
</h4>
<p>JSON 또는 YAML 형태로 모델을 저장하고 불러올 수 있습니다.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">model_from_json</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">model_from_yaml</span>

<span class="c1"># JSON</span>
<span class="n">json_string</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model_from_json</span><span class="p">(</span><span class="n">json_string</span><span class="p">)</span>

<span class="c1"># YAML</span>
<span class="n">yaml_string</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to_yaml</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model_from_yaml</span><span class="p">(</span><span class="n">yaml_string</span><span class="p">)</span>
</pre></div>
<h4 id="모델-가중치만-저장하기/불러오기">모델 가중치만 저장하기/불러오기<a class="anchor-link" href="#%EB%AA%A8%EB%8D%B8-%EA%B0%80%EC%A4%91%EC%B9%98%EB%A7%8C-%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0/%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0">¶</a>
</h4>
<p>모델을 학습시킨 결과 가중치만 HDF5 형식으로 저장하고 불러올 수 있습니다. 저장된 가중치를 사용하기 위해서는 저장한 모델의 구조가 동일해야 합니다</p>
<div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">save_weights</span><span class="p">(</span><span class="s1">'my_model_weights.h5'</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="s1">'my_model_weights.h5'</span><span class="p">)</span>
</pre></div>
<p>Fine-tuning 또는 Transfer-learning 과 같이 불러온 가중치를 다른 모델에서 사용해야 할 경우에는 layer 의 이름을 통해 해당 layer 의 가중치만 불러오기도 가능합니다.</p>
<div class="highlight"><pre><span></span><span class="sd">"""</span>
<span class="sd">Assuming the original model looks like this:</span>
<span class="sd">    model = Sequential()</span>
<span class="sd">    model.add(Dense(2, input_dim=3, name='dense_1'))</span>
<span class="sd">    model.add(Dense(3, name='dense_2'))</span>
<span class="sd">    ...</span>
<span class="sd">    model.save_weights(fname)</span>
<span class="sd">"""</span>

<span class="c1"># new model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'dense_1'</span><span class="p">))</span>  <span class="c1"># will be loaded</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'new_dense'</span><span class="p">))</span>  <span class="c1"># will not be loaded</span>

<span class="c1"># load weights from first model; will only affect the first layer, dense_1.</span>
<span class="n">model</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">by_name</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
<h4 id="모델에-custom-layers-(or-other-custom-objects)-포함된-경우">모델에 custom layers (or other custom objects) 포함된 경우<a class="anchor-link" href="#%EB%AA%A8%EB%8D%B8%EC%97%90-custom-layers-(or-other-custom-objects)-%ED%8F%AC%ED%95%A8%EB%90%9C-%EA%B2%BD%EC%9A%B0">¶</a>
</h4>
<p>자신만의 모델을 위해 custom layer/object/function 를 작성한 경우, 모델을 불러올 때는 해당 정보를 모델에 넘겨 줘야 합니다.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>
<span class="c1"># Assuming your model includes instance of an "AttentionLayer" class</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s1">'my_model.h5'</span><span class="p">,</span> <span class="n">custom_objects</span><span class="o">=</span><span class="p">{</span><span class="s1">'AttentionLayer'</span><span class="p">:</span> <span class="n">AttentionLayer</span><span class="p">})</span>

<span class="kn">from</span> <span class="nn">keras.utils</span> <span class="kn">import</span> <span class="n">CustomObjectScope</span>
<span class="c1"># Alternatively, you can use a custom object scope:</span>
<span class="k">with</span> <span class="n">CustomObjectScope</span><span class="p">({</span><span class="s1">'AttentionLayer'</span><span class="p">:</span> <span class="n">AttentionLayer</span><span class="p">}):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s1">'my_model.h5'</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">model_from_json</span>
<span class="c1"># Custom objects handling works the same way for load_model, model_from_json, model_from_yaml:</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model_from_json</span><span class="p">(</span><span class="n">json_string</span><span class="p">,</span> <span class="n">custom_objects</span><span class="o">=</span><span class="p">{</span><span class="s1">'AttentionLayer'</span><span class="p">:</span> <span class="n">AttentionLayer</span><span class="p">})</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">preprocessing</span><span class="p">,</span> <span class="n">model_selection</span><span class="p">,</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">keras</span> <span class="k">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">layers</span><span class="p">,</span> <span class="n">optimizers</span><span class="p">,</span> <span class="n">utils</span>

<span class="c1"># 데이터</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">n_features</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">n_class</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">np_data_xs</span><span class="p">,</span> <span class="n">np_data_ys</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">make_classification</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="c1"># 데이터 수</span>
    <span class="n">n_features</span><span class="o">=</span><span class="n">n_features</span><span class="p">,</span> <span class="c1"># X feature 수</span>
    <span class="n">n_informative</span><span class="o">=</span><span class="n">n_class</span><span class="p">,</span>
    <span class="n">n_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="c1"># Y class 수</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># 난수 발생용 Seed 값</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"data shape: np_data_xs=</span><span class="si">{}</span><span class="s2">, np_data_ys=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np_data_xs</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np_data_ys</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">np_train_xs</span><span class="p">,</span> <span class="n">np_test_xs</span><span class="p">,</span> <span class="n">np_train_ys</span><span class="p">,</span> <span class="n">np_test_ys</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">np_data_xs</span><span class="p">,</span> <span class="n">np_data_ys</span><span class="p">,</span> 
    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"train shape: np_train_xs=</span><span class="si">{}</span><span class="s2">, np_train_ys=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np_train_xs</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np_train_ys</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"test shape: np_test_xs=</span><span class="si">{}</span><span class="s2">, np_test_ys=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np_test_xs</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np_test_ys</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>

<span class="c1"># 전처리</span>
<span class="n">scaler_xs</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">np_train_scale_xs</span> <span class="o">=</span> <span class="n">scaler_xs</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">np_train_xs</span><span class="p">)</span>
<span class="n">np_test_scale_xs</span> <span class="o">=</span> <span class="n">scaler_xs</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">np_test_xs</span><span class="p">)</span>

<span class="n">np_train_onehot_ys</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">np_utils</span><span class="o">.</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">np_train_ys</span><span class="p">,</span> <span class="n">n_class</span><span class="p">)</span>
<span class="n">np_test_onehot_ys</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">np_utils</span><span class="o">.</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">np_test_ys</span><span class="p">,</span> <span class="n">n_class</span><span class="p">)</span>

<span class="c1"># 모델</span>
<span class="k">def</span> <span class="nf">create_dnn</span><span class="p">(</span><span class="n">n_i</span><span class="p">,</span> <span class="n">n_hs</span><span class="p">,</span> <span class="n">n_o</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>    
    <span class="n">m</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">n_i</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_i</span><span class="p">,)))</span>
    <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">n_h</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_hs</span><span class="p">):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">n_h</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">n_o</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">'softmax'</span><span class="p">))</span>
    <span class="n">sgd</span> <span class="o">=</span> <span class="n">optimizers</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">nesterov</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">sgd</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">'categorical_crossentropy'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">m</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">create_dnn</span><span class="p">(</span><span class="n">n_i</span> <span class="o">=</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">n_hs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span> <span class="n">n_o</span> <span class="o">=</span> <span class="n">n_class</span><span class="p">)</span>

<span class="c1"># 학습</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">model"</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">np_train_scale_xs</span><span class="p">,</span> <span class="n">np_train_onehot_ys</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">'loss'</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">'loss'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">'acc'</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">'acc'</span><span class="p">)</span>    
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>    

<span class="c1"># 평가</span>
<span class="n">np_pred_ys</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">np_test_scale_xs</span><span class="p">)</span>

<span class="n">acc</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">np_test_ys</span><span class="p">,</span> <span class="n">np_pred_ys</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"acc=</span><span class="si">{:.5f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">acc</span><span class="p">))</span>

<span class="n">cr</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">np_test_ys</span><span class="p">,</span> <span class="n">np_pred_ys</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"classification_report</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">cr</span><span class="p">)</span>

<span class="c1"># 모델 저장/로드</span>
<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">'/tmp/my_model.h5'</span><span class="p">)</span>  <span class="c1"># creates a HDF5 file 'my_model.h5'</span>
<span class="k">del</span> <span class="n">model</span>  <span class="c1"># deletes the existing model</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">'/tmp/my_model.h5'</span><span class="p">)</span>

<span class="c1"># 재평가</span>
<span class="n">np_pred_ys</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_classes</span><span class="p">(</span><span class="n">np_test_scale_xs</span><span class="p">)</span>

<span class="n">acc</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">np_test_ys</span><span class="p">,</span> <span class="n">np_pred_ys</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"acc=</span><span class="si">{:.5f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">acc</span><span class="p">))</span>

<span class="n">cr</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">np_test_ys</span><span class="p">,</span> <span class="n">np_pred_ys</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"classification_report</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">cr</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>data shape: np_data_xs=(10000, 10), np_data_ys=(10000,)
train shape: np_train_xs=(7000, 10), np_train_ys=(7000,)
test shape: np_test_xs=(3000, 10), np_test_ys=(3000,)

model
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_2 (Dense)              (None, 10)                110       
_________________________________________________________________
dense_3 (Dense)              (None, 16)                176       
_________________________________________________________________
dense_4 (Dense)              (None, 16)                272       
_________________________________________________________________
dense_5 (Dense)              (None, 3)                 51        
=================================================================
Total params: 609
Trainable params: 609
Non-trainable params: 0
_________________________________________________________________
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>acc=0.92733
classification_report
               precision    recall  f1-score   support

           0       0.93      0.90      0.91      1021
           1       0.92      0.92      0.92      1011
           2       0.93      0.97      0.95       968

   micro avg       0.93      0.93      0.93      3000
   macro avg       0.93      0.93      0.93      3000
weighted avg       0.93      0.93      0.93      3000

acc=0.92733
classification_report
               precision    recall  f1-score   support

           0       0.93      0.90      0.91      1021
           1       0.92      0.92      0.92      1011
           2       0.93      0.97      0.95       968

   micro avg       0.93      0.93      0.93      3000
   macro avg       0.93      0.93      0.93      3000
weighted avg       0.93      0.93      0.93      3000

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
</div>
    </div>
        <section class="comments"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="comafire",
            disqus_url="https://comafire.github.io/pages/ml-model-persistence/",
        disqus_title="Machine Learning - Model Persistence",
        disqus_identifier="cache/pages/ml-model-persistence.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha256-SDRP1VVYu+tgAGKhddBSl5+ezofHKZeI+OzxakbIe/Y=" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script></article><!--End of body content--><footer id="footer">
            Contents © 2020         <a href="mailto:comafire@gmail.com">comafire</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


        <script src="../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
