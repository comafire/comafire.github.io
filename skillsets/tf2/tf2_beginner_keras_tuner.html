
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Keras Tuner &#8212; 데사견문록</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Images" href="tf2_beginner_images.html" />
    <link rel="prev" title="Save &amp; Load" href="tf2_beginner_save_load.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">데사견문록</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../readme.html">
   데이터사이언스견문록
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  End to End Data Science
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../e2eds/data_science.html">
   Data Science
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../e2eds/e2eds.html">
   End to End Data Science
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Episodes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../episodes/tbc.html">
   TO BE CONTINUE…
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  skillsets
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="tf2.html">
   Tensorflow2
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="tf2_10mins.html">
     TF2 10mins
    </a>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="tf2_beginner.html">
     TF2 Beginner
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_beginner_quickstart.html">
       Quickstart
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_beginner_image_classification.html">
       Image Classification
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_beginner_text_classification.html">
       Text Classification
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_beginner_hub_text_classification.html">
       Text Classification with Hub
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_beginner_regression.html">
       Regression
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_beginner_overfit_underfit.html">
       Overfit &amp; Underfit
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_beginner_save_load.html">
       Save &amp; Load
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       Keras Tuner
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_beginner_images.html">
       Images
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_beginner_csv.html">
       CSV
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_beginner_numpy.html">
       Numpy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_beginner_pandas.html">
       Pandas
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_beginner_text.html">
       Text
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_beginner_unicode.html">
       Unicode
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_beginner_tftext.html">
       TF.Text
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_beginner_subwords_tokenizer.html">
       Subword Tokenization
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_beginner_tfrecord.html">
       TFRecord and tf.train.Example
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_beginner_tfio.html">
       TF I/O
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="tf2_advanced.html">
     TF2 Advanced
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_advanced_quickstart.html">
       Quickstart
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_advanced_image_cnn.html">
       Image CNN
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_advanced_image_classification.html">
       Image Classification
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_advanced_transfer_learning.html">
       Transfer learning and fine-tuning
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_advanced_transfer_learning_with_hub.html">
       Transfer learning with TensorFlow Hub
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_advanced_data_augmentation.html">
       Data augmentation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="tf2_advanced_image_segmentation.html">
       Image Segmentation
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../keras/keras.html">
   Keras
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../keras/keras_10mins.html">
     Keras 10mins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../keras/keras_dnn_regression.html">
     DNN Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../keras/keras_dnn_classification.html">
     DNN Classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../keras/keras_deepmf.html">
     Deep MF
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../sklearn/sklearn.html">
   Scikit-Learn
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../sklearn/sklearn_10mins.html">
     Scikit-Learn 10mins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sklearn/sklearn_datasets.html">
     Datasets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sklearn/sklearn_preprocessing.html">
     Preprocessing
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../sklearn/sklearn_regression.html">
     Regression
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../sklearn/sklearn_linear_regression.html">
       Linear Regression
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sklearn/sklearn_polynomial_regression.html">
       Polynomial Regression
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sklearn/sklearn_sgd_regression.html">
       SGD Regression
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sklearn/sklearn_svm_regression.html">
       SVM Regression
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sklearn/sklearn_nearest_neighbor_regression.html">
       Nearest Neighbors Regression
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sklearn/sklearn_ensemble_regression.html">
       Ensemble Regression
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sklearn/sklearn_eval_regression.html">
       Regression Evaluation
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../sklearn/sklearn_classification.html">
     Classification
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../sklearn/sklearn_logistic_regression.html">
       Logistic Regression
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sklearn/sklearn_sgd_classification.html">
       SGD Classification
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sklearn/sklearn_svm_classification.html">
       SVM Classification
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sklearn/sklearn_nearest_neighbor_classification.html">
       Nearest Neighbors Classification
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sklearn/sklearn_ensemble_classification.html">
       Ensemble Classification
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sklearn/sklearn_eval_classification.html">
       Classification Evaluation
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../sklearn/sklearn_clustering.html">
     Clustering
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../sklearn/sklearn_kmeans.html">
       K-Means
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sklearn/sklearn_mean_shift.html">
       Mean Shift
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sklearn/sklearn_spectral_clustering.html">
       Spectral Clustering
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sklearn/sklearn_eval_clustering.html">
       Clustering Evaluation
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sklearn/sklearn_feature_selection.html">
     Feature Selection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sklearn/sklearn_feature_extraction.html">
     Feature Extraction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sklearn/sklearn_split_train_test.html">
     Train/Valid/Test Dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sklearn/sklearn_model_persistence.html">
     Model Persistence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sklearn/sklearn_hyper_parameter_tunning.html">
     Hyper Parameter Tunning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../sklearn/sklearn_anomaly_detection.html">
     Anomaly Detection
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../dlib/dlib.html">
   Dlib
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../dlib/dlib_frontal_face_detector.html">
     Frontal Face Detector
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../surprise/surprise.html">
   Surprise
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../surprise/surprise_collaborative_filtering.html">
     Collaborative Filtering
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../imblearn/imblearn.html">
   Imblearn
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../imblearn/imblearn_imbalanced_class.html">
     Imbalanced Class
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../spark/spark.html">
   Spark
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../spark/spark_dataframe_10mins.html">
     Spark DataFrame 10mins
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../pandas/pandas.html">
   Pandas
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../pandas/pandas_10mins.html">
     Pandas 10mins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pandas/pandas_missing_value.html">
     Missing Value
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pandas/pandas_data_description.html">
     Data Description
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../numpy/numpy.html">
   Numpy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../numpy/numpy_10mins.html">
     Numpy 10mins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../numpy/numpy_outlier.html">
     Outlier
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../jupyter/jupyter.html">
   Jupyter
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/jupyter_cloud.html">
     Jupyter (Cloud)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/jupyter_native_ubuntu.html">
     Jupyter (Ubuntu)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/jupyter_native_macos_x86.html">
     Jupyter (macOS x86)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/jupyter_docker.html">
     Jupyter (Docker)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../skp/skp.html">
   St. Kilda Pier (SKP)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../skp/skp_n4e_vscode.html">
     Native Visual Studio Code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../skp/skp_n4e_jupyter.html">
     Native Jupyter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../skp/skp_d4r_jupyter.html">
     Docker Jupyter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../skp/skp_n4e_traefik.html">
     Native Traefik
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ansible/ansible.html">
   Ansible
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ansible/ansible_skp_ubuntu.html">
     ansible_skp_ubuntu
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../vagrant/vagrant_virtualbox.html">
   Vagrant &amp; Virtualbox
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../vagrant/vagrant_skp_single.html">
     vagrant_skp_single
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  devicesets
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../devicesets/computer.html">
   Computer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../devicesets/network.html">
   Network
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../devicesets/gce_nested_vm.html">
   Google Computer Engine
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/skillsets/tf2/tf2_beginner_keras_tuner.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/comafire/comafire.github.io"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/comafire/comafire.github.io/issues/new?title=Issue%20on%20page%20%2Fskillsets/tf2/tf2_beginner_keras_tuner.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/comafire/comafire.github.io/master?urlpath=tree/skillsets/tf2/tf2_beginner_keras_tuner.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#copyright-2020-the-tensorflow-authors">
   Copyright 2020 The TensorFlow Authors.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-to-the-keras-tuner">
   Introduction to the Keras Tuner
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#download-and-prepare-the-dataset">
   Download and prepare the dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#define-the-model">
   Define the model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#instantiate-the-tuner-and-perform-hypertuning">
   Instantiate the tuner and perform hypertuning
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#train-the-model">
   Train the model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="keras-tuner">
<h1>Keras Tuner<a class="headerlink" href="#keras-tuner" title="Permalink to this headline">¶</a></h1>
<p>TensorFlow2 공식 홈페이지에 나와 있는 코드들을 수행해 보면서 빠르게 TensorFlow2를 익혀 봅니다.</p>
<p><a class="reference external" href="https://www.tensorflow.org/tutorials/keras/keras_tuner">https://www.tensorflow.org/tutorials/keras/keras_tuner</a></p>
<div class="section" id="copyright-2020-the-tensorflow-authors">
<h2>Copyright 2020 The TensorFlow Authors.<a class="headerlink" href="#copyright-2020-the-tensorflow-authors" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1"># https://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 설치</span>
<span class="o">!</span>pip install -q --upgrade pip
<span class="o">!</span>pip install -q -U keras-tuner
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 경고 메시지 출력 끄기</span>
<span class="kn">import</span> <span class="nn">warnings</span> 
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="c1"># 노트북 셀 표시를 브라우저 전체 폭 사용하기</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;style&gt;.container { width:100% !important; }&lt;/style&gt;&quot;</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">clear_output</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">shutil</span>

<span class="n">rseed</span> <span class="o">=</span> <span class="mi">22</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">rseed</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">rseed</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">formatter</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;float_kind&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:.5f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">})</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> 
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> 
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">float_format</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:,.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span>

<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="n">rseed</span><span class="p">)</span>
<span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">set_floatx</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span> <span class="c1"># keras default float type 설정</span>

<span class="kn">import</span> <span class="nn">tensorflow_hub</span> <span class="k">as</span> <span class="nn">tfhub</span>
<span class="kn">import</span> <span class="nn">tensorflow_datasets</span> <span class="k">as</span> <span class="nn">tfds</span>

<span class="kn">import</span> <span class="nn">kerastuner</span> <span class="k">as</span> <span class="nn">kt</span>

<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;python ver=</span><span class="si">{</span><span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pandas ver=</span><span class="si">{</span><span class="n">pd</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;numpy ver=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tensorflow ver=</span><span class="si">{</span><span class="n">tf</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tensorflow execuring eagerly=</span><span class="si">{</span><span class="n">tf</span><span class="o">.</span><span class="n">executing_eagerly</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tensorflow hub ver=</span><span class="si">{</span><span class="n">tfhub</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tensorflow GPU=</span><span class="si">{</span><span class="s1">&#39;True&#39;</span> <span class="k">if</span> <span class="n">tf</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">list_physical_devices</span><span class="p">(</span><span class="s1">&#39;GPU&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;False&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;keras tuner ver=</span><span class="si">{</span><span class="n">kt</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;senborn ver=</span><span class="si">{</span><span class="n">sns</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>.container { width:100% !important; }</style></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>python ver=3.7.6 (default, Nov 21 2020, 22:51:13) 
[Clang 12.0.0 (clang-1200.0.32.27)]
pandas ver=1.0.5
numpy ver=1.19.5
tensorflow ver=2.4.1
tensorflow execuring eagerly=True
tensorflow hub ver=0.11.0
tensorflow GPU=False
keras tuner ver=1.0.2
senborn ver=0.10.0
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="introduction-to-the-keras-tuner">
<h2>Introduction to the Keras Tuner<a class="headerlink" href="#introduction-to-the-keras-tuner" title="Permalink to this headline">¶</a></h2>
<table class="tfo-notebook-buttons" align="left">
  <td>
    <a target="_blank" href="https://www.tensorflow.org/tutorials/keras/keras_tuner"><img src="https://www.tensorflow.org/images/tf_logo_32px.png" />View on TensorFlow.org</a>
  </td>
  <td>
    <a target="_blank" href="https://colab.research.google.com/github/tensorflow/docs/blob/master/site/en/tutorials/keras/keras_tuner.ipynb"><img src="https://www.tensorflow.org/images/colab_logo_32px.png" />Run in Google Colab</a>
  </td>
  <td>
    <a target="_blank" href="https://github.com/tensorflow/docs/blob/master/site/en/tutorials/keras/keras_tuner.ipynb"><img src="https://www.tensorflow.org/images/GitHub-Mark-32px.png" />View source on GitHub</a>
  </td>
  <td>
    <a href="https://storage.googleapis.com/tensorflow_docs/docs/site/en/tutorials/keras/keras_tuner.ipynb"><img src="https://www.tensorflow.org/images/download_logo_32px.png" />Download notebook</a>
  </td>
</table>
*</div>
<hr class="docutils" />
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The Keras Tuner is a library that helps you pick the optimal set of hyperparameters for your TensorFlow program. The process of selecting the right set of hyperparameters for your machine learning (ML) application is called <em>hyperparameter tuning</em> or <em>hypertuning</em>.</p>
<p>Hyperparameters are the variables that govern the training process and the topology of an ML model. These variables remain constant over the training process and directly impact the performance of your ML program. Hyperparameters are of two types:</p>
<ol class="simple">
<li><p><strong>Model hyperparameters</strong> which influence model selection such as the number and width of hidden layers</p></li>
<li><p><strong>Algorithm hyperparameters</strong> which influence the speed and quality of the learning algorithm such as the learning rate for Stochastic Gradient Descent (SGD) and the number of nearest neighbors for a k Nearest Neighbors (KNN) classifier</p></li>
</ol>
<p>In this tutorial, you will use the Keras Tuner to perform hypertuning for an image classification application.</p>
</div>
<div class="section" id="download-and-prepare-the-dataset">
<h2>Download and prepare the dataset<a class="headerlink" href="#download-and-prepare-the-dataset" title="Permalink to this headline">¶</a></h2>
<p>In this tutorial, you will use the Keras Tuner to find the best hyperparameters for a machine learning model that classifies images of clothing from the <a class="reference external" href="https://github.com/zalandoresearch/fashion-mnist">Fashion MNIST dataset</a>.</p>
<p>Load the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">img_train</span><span class="p">,</span> <span class="n">label_train</span><span class="p">),</span> <span class="p">(</span><span class="n">img_test</span><span class="p">,</span> <span class="n">label_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">fashion_mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalize pixel values between 0 and 1</span>
<span class="n">img_train</span> <span class="o">=</span> <span class="n">img_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.0</span>
<span class="n">img_test</span> <span class="o">=</span> <span class="n">img_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.0</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="define-the-model">
<h2>Define the model<a class="headerlink" href="#define-the-model" title="Permalink to this headline">¶</a></h2>
<p>When you build a model for hypertuning, you also define the hyperparameter search space in addition to the model architecture. The model you set up for hypertuning is called a <em>hypermodel</em>.</p>
<p>You can define a hypermodel through two approaches:</p>
<ul class="simple">
<li><p>By using a model builder function</p></li>
<li><p>By subclassing the <code class="docutils literal notranslate"><span class="pre">HyperModel</span></code> class of the Keras Tuner API</p></li>
</ul>
<p>You can also use two pre-defined <code class="docutils literal notranslate"><span class="pre">HyperModel</span></code> classes - <a class="reference external" href="https://keras-team.github.io/keras-tuner/documentation/hypermodels/#hyperxception-class">HyperXception</a> and <a class="reference external" href="https://keras-team.github.io/keras-tuner/documentation/hypermodels/#hyperresnet-class">HyperResNet</a> for computer vision applications.</p>
<p>In this tutorial, you use a model builder function to define the image classification model. The model builder function returns a compiled model and uses hyperparameters you define inline to hypertune the model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">model_builder</span><span class="p">(</span><span class="n">hp</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)))</span>

    <span class="c1"># Tune the number of units in the first Dense layer</span>
    <span class="c1"># Choose an optimal value between 32-512</span>
    <span class="n">hp_units</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">Int</span><span class="p">(</span><span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="n">min_value</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="n">hp_units</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Tune the learning rate for the optimizer</span>
    <span class="c1"># Choose an optimal value from 0.01, 0.001, or 0.0001</span>
    <span class="n">hp_learning_rate</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">Choice</span><span class="p">(</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">])</span>

    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="n">hp_learning_rate</span><span class="p">),</span>
                <span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">model</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="instantiate-the-tuner-and-perform-hypertuning">
<h2>Instantiate the tuner and perform hypertuning<a class="headerlink" href="#instantiate-the-tuner-and-perform-hypertuning" title="Permalink to this headline">¶</a></h2>
<p>Instantiate the tuner to perform the hypertuning. The Keras Tuner has four tuners available - <code class="docutils literal notranslate"><span class="pre">RandomSearch</span></code>, <code class="docutils literal notranslate"><span class="pre">Hyperband</span></code>, <code class="docutils literal notranslate"><span class="pre">BayesianOptimization</span></code>, and <code class="docutils literal notranslate"><span class="pre">Sklearn</span></code>. In this tutorial, you use the <a class="reference external" href="https://arxiv.org/pdf/1603.06560.pdf">Hyperband</a> tuner.</p>
<p>To instantiate the Hyperband tuner, you must specify the hypermodel, the <code class="docutils literal notranslate"><span class="pre">objective</span></code> to optimize and the maximum number of epochs to train (<code class="docutils literal notranslate"><span class="pre">max_epochs</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tuner</span> <span class="o">=</span> <span class="n">kt</span><span class="o">.</span><span class="n">Hyperband</span><span class="p">(</span><span class="n">model_builder</span><span class="p">,</span>
                     <span class="n">objective</span><span class="o">=</span><span class="s1">&#39;val_accuracy&#39;</span><span class="p">,</span>
                     <span class="n">max_epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                     <span class="n">factor</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                     <span class="n">directory</span><span class="o">=</span><span class="s1">&#39;/tmp/my_dir&#39;</span><span class="p">,</span>
                     <span class="n">project_name</span><span class="o">=</span><span class="s1">&#39;intro_to_kt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The Hyperband tuning algorithm uses adaptive resource allocation and early-stopping to quickly converge on a high-performing model. This is done using a sports championship style bracket. The algorithm trains a large number of models for a few epochs and carries forward only the top-performing half of models to the next round. Hyperband determines the number of models to train in a bracket by computing 1 + log<sub><code class="docutils literal notranslate"><span class="pre">factor</span></code></sub>(<code class="docutils literal notranslate"><span class="pre">max_epochs</span></code>) and rounding it up to the nearest integer.</p>
<p>Create a callback to stop training early after reaching a certain value for the validation loss.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stop_early</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Run the hyperparameter search. The arguments for the search method are the same as those used for <code class="docutils literal notranslate"><span class="pre">tf.keras.model.fit</span></code> in addition to the callback above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tuner</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">img_train</span><span class="p">,</span> <span class="n">label_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">stop_early</span><span class="p">])</span>

<span class="c1"># Get the optimal hyperparameters</span>
<span class="n">best_hps</span><span class="o">=</span><span class="n">tuner</span><span class="o">.</span><span class="n">get_best_hyperparameters</span><span class="p">(</span><span class="n">num_trials</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">The hyperparameter search is complete. The optimal number of units in the first densely-connected</span>
<span class="s2">layer is </span><span class="si">{</span><span class="n">best_hps</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;units&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> and the optimal learning rate for the optimizer</span>
<span class="s2">is </span><span class="si">{</span><span class="n">best_hps</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">.</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trial 30 Complete [00h 00m 12s]
val_accuracy: 0.8644166588783264

Best val_accuracy So Far: 0.8923333287239075
Total elapsed time: 00h 03m 31s
INFO:tensorflow:Oracle triggered exit

The hyperparameter search is complete. The optimal number of units in the first densely-connected
layer is 448 and the optimal learning rate for the optimizer
is 0.001.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="train-the-model">
<h2>Train the model<a class="headerlink" href="#train-the-model" title="Permalink to this headline">¶</a></h2>
<p>Find the optimal number of epochs to train the model with the hyperparameters obtained from the search.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build the model with the optimal hyperparameters and train it on the data for 50 epochs</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tuner</span><span class="o">.</span><span class="n">hypermodel</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">best_hps</span><span class="p">)</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">img_train</span><span class="p">,</span> <span class="n">label_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">val_acc_per_epoch</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_accuracy&#39;</span><span class="p">]</span>
<span class="n">best_epoch</span> <span class="o">=</span> <span class="n">val_acc_per_epoch</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">val_acc_per_epoch</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best epoch: </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">best_epoch</span><span class="p">,))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/50
1500/1500 [==============================] - 3s 2ms/step - loss: 0.6073 - accuracy: 0.7875 - val_loss: 0.4231 - val_accuracy: 0.8441
Epoch 2/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.3821 - accuracy: 0.8623 - val_loss: 0.3635 - val_accuracy: 0.8700
Epoch 3/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.3334 - accuracy: 0.8787 - val_loss: 0.3634 - val_accuracy: 0.8671
Epoch 4/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.3102 - accuracy: 0.8862 - val_loss: 0.3436 - val_accuracy: 0.8762
Epoch 5/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.2918 - accuracy: 0.8925 - val_loss: 0.3253 - val_accuracy: 0.8859
Epoch 6/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.2721 - accuracy: 0.9008 - val_loss: 0.3142 - val_accuracy: 0.8866
Epoch 7/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.2591 - accuracy: 0.9032 - val_loss: 0.3073 - val_accuracy: 0.8879
Epoch 8/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.2423 - accuracy: 0.9071 - val_loss: 0.3241 - val_accuracy: 0.8860
Epoch 9/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.2293 - accuracy: 0.9127 - val_loss: 0.3216 - val_accuracy: 0.8858
Epoch 10/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.2248 - accuracy: 0.9147 - val_loss: 0.3188 - val_accuracy: 0.8875
Epoch 11/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.2121 - accuracy: 0.9201 - val_loss: 0.3363 - val_accuracy: 0.8838
Epoch 12/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.2111 - accuracy: 0.9198 - val_loss: 0.3165 - val_accuracy: 0.8914
Epoch 13/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1974 - accuracy: 0.9261 - val_loss: 0.3319 - val_accuracy: 0.8904
Epoch 14/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1910 - accuracy: 0.9285 - val_loss: 0.3374 - val_accuracy: 0.8905
Epoch 15/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1825 - accuracy: 0.9309 - val_loss: 0.3352 - val_accuracy: 0.8930
Epoch 16/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1755 - accuracy: 0.9341 - val_loss: 0.3331 - val_accuracy: 0.8920
Epoch 17/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1698 - accuracy: 0.9346 - val_loss: 0.3291 - val_accuracy: 0.8940
Epoch 18/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1684 - accuracy: 0.9370 - val_loss: 0.3462 - val_accuracy: 0.8937
Epoch 19/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1628 - accuracy: 0.9386 - val_loss: 0.3641 - val_accuracy: 0.8930
Epoch 20/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1577 - accuracy: 0.9404 - val_loss: 0.3552 - val_accuracy: 0.8908
Epoch 21/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1511 - accuracy: 0.9444 - val_loss: 0.3538 - val_accuracy: 0.8947
Epoch 22/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1470 - accuracy: 0.9446 - val_loss: 0.3521 - val_accuracy: 0.8941
Epoch 23/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1384 - accuracy: 0.9472 - val_loss: 0.3713 - val_accuracy: 0.8924
Epoch 24/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1362 - accuracy: 0.9489 - val_loss: 0.3653 - val_accuracy: 0.8973
Epoch 25/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1304 - accuracy: 0.9506 - val_loss: 0.3791 - val_accuracy: 0.8938
Epoch 26/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1306 - accuracy: 0.9515 - val_loss: 0.4075 - val_accuracy: 0.8904
Epoch 27/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1310 - accuracy: 0.9509 - val_loss: 0.3909 - val_accuracy: 0.8954
Epoch 28/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1216 - accuracy: 0.9550 - val_loss: 0.3806 - val_accuracy: 0.8981
Epoch 29/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1154 - accuracy: 0.9577 - val_loss: 0.3932 - val_accuracy: 0.8951
Epoch 30/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1108 - accuracy: 0.9569 - val_loss: 0.4137 - val_accuracy: 0.8935
Epoch 31/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1118 - accuracy: 0.9592 - val_loss: 0.4026 - val_accuracy: 0.8919
Epoch 32/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1091 - accuracy: 0.9591 - val_loss: 0.3924 - val_accuracy: 0.8959
Epoch 33/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1039 - accuracy: 0.9599 - val_loss: 0.4264 - val_accuracy: 0.8932
Epoch 34/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1049 - accuracy: 0.9603 - val_loss: 0.4296 - val_accuracy: 0.8938
Epoch 35/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1038 - accuracy: 0.9603 - val_loss: 0.4194 - val_accuracy: 0.8942
Epoch 36/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.0979 - accuracy: 0.9631 - val_loss: 0.4275 - val_accuracy: 0.8982
Epoch 37/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.1032 - accuracy: 0.9608 - val_loss: 0.4372 - val_accuracy: 0.8936
Epoch 38/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.0962 - accuracy: 0.9641 - val_loss: 0.4205 - val_accuracy: 0.8978
Epoch 39/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.0886 - accuracy: 0.9671 - val_loss: 0.4362 - val_accuracy: 0.8986
Epoch 40/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.0906 - accuracy: 0.9654 - val_loss: 0.4635 - val_accuracy: 0.8926
Epoch 41/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.0894 - accuracy: 0.9665 - val_loss: 0.4796 - val_accuracy: 0.8920
Epoch 42/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.0842 - accuracy: 0.9688 - val_loss: 0.4591 - val_accuracy: 0.8997
Epoch 43/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.0841 - accuracy: 0.9687 - val_loss: 0.4661 - val_accuracy: 0.8971
Epoch 44/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.0844 - accuracy: 0.9680 - val_loss: 0.4779 - val_accuracy: 0.8964
Epoch 45/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.0760 - accuracy: 0.9721 - val_loss: 0.4896 - val_accuracy: 0.8946
Epoch 46/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.0773 - accuracy: 0.9722 - val_loss: 0.4855 - val_accuracy: 0.8982
Epoch 47/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.0756 - accuracy: 0.9720 - val_loss: 0.5148 - val_accuracy: 0.8907
Epoch 48/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.0842 - accuracy: 0.9678 - val_loss: 0.5309 - val_accuracy: 0.8943
Epoch 49/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.0748 - accuracy: 0.9728 - val_loss: 0.5081 - val_accuracy: 0.8953
Epoch 50/50
1500/1500 [==============================] - 2s 1ms/step - loss: 0.0730 - accuracy: 0.9732 - val_loss: 0.5079 - val_accuracy: 0.8957
Best epoch: 42
</pre></div>
</div>
</div>
</div>
<p>Re-instantiate the hypermodel and train it with the optimal number of epochs from above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hypermodel</span> <span class="o">=</span> <span class="n">tuner</span><span class="o">.</span><span class="n">hypermodel</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">best_hps</span><span class="p">)</span>

<span class="c1"># Retrain the model</span>
<span class="c1"># hypermodel.fit(img_test, label_test, epochs=best_epoch) -&gt; test 이미지로 학습하도록 오류가 있어 train 이미지로 수정</span>
<span class="n">hypermodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">img_train</span><span class="p">,</span> <span class="n">label_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">best_epoch</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/42
1875/1875 [==============================] - 2s 910us/step - loss: 0.5968 - accuracy: 0.7862
Epoch 2/42
1875/1875 [==============================] - 2s 892us/step - loss: 0.3693 - accuracy: 0.8639
Epoch 3/42
1875/1875 [==============================] - 2s 898us/step - loss: 0.3220 - accuracy: 0.8808
Epoch 4/42
1875/1875 [==============================] - 2s 880us/step - loss: 0.2989 - accuracy: 0.8913
Epoch 5/42
1875/1875 [==============================] - 2s 1ms/step - loss: 0.2748 - accuracy: 0.8984
Epoch 6/42
1875/1875 [==============================] - 2s 922us/step - loss: 0.2639 - accuracy: 0.9012
Epoch 7/42
1875/1875 [==============================] - 2s 907us/step - loss: 0.2474 - accuracy: 0.9075
Epoch 8/42
1875/1875 [==============================] - 2s 900us/step - loss: 0.2396 - accuracy: 0.9114
Epoch 9/42
1875/1875 [==============================] - 2s 918us/step - loss: 0.2315 - accuracy: 0.9120
Epoch 10/42
1875/1875 [==============================] - 2s 913us/step - loss: 0.2251 - accuracy: 0.9154
Epoch 11/42
1875/1875 [==============================] - 2s 887us/step - loss: 0.2129 - accuracy: 0.9205
Epoch 12/42
1875/1875 [==============================] - 2s 1ms/step - loss: 0.2022 - accuracy: 0.9244
Epoch 13/42
1875/1875 [==============================] - 2s 1ms/step - loss: 0.1928 - accuracy: 0.9268
Epoch 14/42
1875/1875 [==============================] - 2s 952us/step - loss: 0.1821 - accuracy: 0.9310
Epoch 15/42
1875/1875 [==============================] - 2s 972us/step - loss: 0.1766 - accuracy: 0.9340
Epoch 16/42
1875/1875 [==============================] - 2s 1ms/step - loss: 0.1759 - accuracy: 0.9340
Epoch 17/42
1875/1875 [==============================] - 2s 1ms/step - loss: 0.1719 - accuracy: 0.9345
Epoch 18/42
1875/1875 [==============================] - 3s 1ms/step - loss: 0.1627 - accuracy: 0.9371
Epoch 19/42
1875/1875 [==============================] - 2s 1ms/step - loss: 0.1579 - accuracy: 0.9386
Epoch 20/42
1875/1875 [==============================] - 2s 1ms/step - loss: 0.1529 - accuracy: 0.9429
Epoch 21/42
1875/1875 [==============================] - 2s 1ms/step - loss: 0.1492 - accuracy: 0.9442
Epoch 22/42
1875/1875 [==============================] - 2s 1ms/step - loss: 0.1409 - accuracy: 0.9456
Epoch 23/42
1875/1875 [==============================] - 2s 1ms/step - loss: 0.1419 - accuracy: 0.9475
Epoch 24/42
1875/1875 [==============================] - 2s 944us/step - loss: 0.1383 - accuracy: 0.9472
Epoch 25/42
1875/1875 [==============================] - 2s 992us/step - loss: 0.1338 - accuracy: 0.9482
Epoch 26/42
1875/1875 [==============================] - 2s 984us/step - loss: 0.1322 - accuracy: 0.9498
Epoch 27/42
1875/1875 [==============================] - 2s 982us/step - loss: 0.1251 - accuracy: 0.9515
Epoch 28/42
1875/1875 [==============================] - 2s 986us/step - loss: 0.1214 - accuracy: 0.9540
Epoch 29/42
1875/1875 [==============================] - 2s 964us/step - loss: 0.1183 - accuracy: 0.9543
Epoch 30/42
1875/1875 [==============================] - 2s 947us/step - loss: 0.1206 - accuracy: 0.9536
Epoch 31/42
1875/1875 [==============================] - 2s 921us/step - loss: 0.1161 - accuracy: 0.9571
Epoch 32/42
1875/1875 [==============================] - 2s 949us/step - loss: 0.1050 - accuracy: 0.9605
Epoch 33/42
1875/1875 [==============================] - 2s 959us/step - loss: 0.1107 - accuracy: 0.9580
Epoch 34/42
1875/1875 [==============================] - 2s 942us/step - loss: 0.1057 - accuracy: 0.9608
Epoch 35/42
1875/1875 [==============================] - 2s 935us/step - loss: 0.1086 - accuracy: 0.9591
Epoch 36/42
1875/1875 [==============================] - 2s 937us/step - loss: 0.1017 - accuracy: 0.9615
Epoch 37/42
1875/1875 [==============================] - 2s 932us/step - loss: 0.1009 - accuracy: 0.9624
Epoch 38/42
1875/1875 [==============================] - 2s 993us/step - loss: 0.1029 - accuracy: 0.9619
Epoch 39/42
1875/1875 [==============================] - 2s 988us/step - loss: 0.0955 - accuracy: 0.9626
Epoch 40/42
1875/1875 [==============================] - 2s 956us/step - loss: 0.0966 - accuracy: 0.9642
Epoch 41/42
1875/1875 [==============================] - 2s 1ms/step - loss: 0.0942 - accuracy: 0.9650
Epoch 42/42
1875/1875 [==============================] - 2s 1ms/step - loss: 0.0913 - accuracy: 0.9661
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;tensorflow.python.keras.callbacks.History at 0x193726dd0&gt;
</pre></div>
</div>
</div>
</div>
<p>To finish this tutorial, evaluate the hypermodel on the test data.</p>
<blockquote>
<div><p>예제에서 보여준 학습 방식은 save and load 예제에서 나온 checkpoint callback 을 활용하는 것이 더 명확하고 간편합니다.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eval_result</span> <span class="o">=</span> <span class="n">hypermodel</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">img_test</span><span class="p">,</span> <span class="n">label_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[test loss, test accuracy]:&quot;</span><span class="p">,</span> <span class="n">eval_result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>313/313 [==============================] - 1s 1ms/step - loss: 0.5073 - accuracy: 0.8956A: 0s - loss: 0.5020 - ac
[test loss, test accuracy]: [0.5072923302650452, 0.8956000208854675]
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">/tmp/my_dir/intro_to_kt</span></code> directory contains detailed logs and checkpoints for every trial (model configuration) run during the hyperparameter search. If you re-run the hyperparameter search, the Keras Tuner uses the existing state from these logs to resume the search. To disable this behavior, pass an additional <code class="docutils literal notranslate"><span class="pre">overwrite=True</span></code> argument while instantiating the tuner.</p>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>In this tutorial, you learned how to use the Keras Tuner to tune hyperparameters for a model. To learn more about the Keras Tuner, check out these additional resources:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://blog.tensorflow.org/2020/01/hyperparameter-tuning-with-keras-tuner.html">Keras Tuner on the TensorFlow blog</a></p></li>
<li><p><a class="reference external" href="https://keras-team.github.io/keras-tuner/">Keras Tuner website</a></p></li>
</ul>
<p>Also check out the <a class="reference external" href="https://www.tensorflow.org/tensorboard/hyperparameter_tuning_with_hparams">HParams Dashboard</a> in TensorBoard to interactively tune your model hyperparameters.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./skillsets/tf2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="tf2_beginner_save_load.html" title="previous page">Save &amp; Load</a>
    <a class='right-next' id="next-link" href="tf2_beginner_images.html" title="next page">Images</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By comafire<br/>
        
            &copy; Copyright 2015.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-81648003-1', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </body>
</html>