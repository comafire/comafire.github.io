<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Jupyter-&#50640;&#49436;-Notebook-&#51012;-Shell-&#49345;&#50640;&#49436;-&#49688;&#54665;&#54616;&#44592;">Jupyter &#50640;&#49436; Notebook &#51012; Shell &#49345;&#50640;&#49436; &#49688;&#54665;&#54616;&#44592;<a class="anchor-link" href="#Jupyter-&#50640;&#49436;-Notebook-&#51012;-Shell-&#49345;&#50640;&#49436;-&#49688;&#54665;&#54616;&#44592;">&#182;</a></h1><p>Jupyter를 서버에 설치해 놓고 사용하다보면 트레이닝 중 일때 갑자기 자리를 옮겨야 할 때가 생기면 중간에 멈추고 다시 트레이닝 해야 할때가 종종 있습니다. 이럴때는 Jupyter의 Terminal 상에서 바로 nbconvert를 통해서 Notebook을 끊김 없이 수행할 수 있습니다.</p>
<!-- TEASER_END -->
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>테스트를 위해서 1초마다 i 값을 파일에 추가하는 Notebook 파일을 만듭니다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;test.log&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0
1
2
3
4
5
6
7
8
9
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Jupyter Nbconvert 는 노트북 셀의 응답이 기본 30초가 넘어가면 에러를 일으킵니다. 이것을 방지하기 위해서 nbconvert의 설정 파일에 timeout 값을 아래와 같이 -1 로 설정하여 무제한으로 늘립니다. (파일이 없다면 아래 내용으로 만들어 주면 됩니다, <a href="https://nbconvert.readthedocs.io/en/latest/config_options.html">https://nbconvert.readthedocs.io/en/latest/config_options.html</a>)</p>

<pre><code>&gt; cat /root/.jupyter/jupyter_nbconvert_config.py

# Configuration file for jupyter nbconvert.
import os
from IPython.lib import passwd

c = get_config()
c.ExecutePreprocessor.timeout = -1
print(c)</code></pre>
<p>이제 Notebook 파일을 Jupyter Terminal 을 열고 아래 명령으로 수행하면 됩니다.</p>
<p>서버의 Docker 위에 Jupyter 가 올라가 있기 때문에 Terminal 창을 닫더라도 서버 또는 Docker 데몬전체가 죽지 않는 이상 다시 같은 Terminal 창에 접속하면 이전 화면을 이어서 다시 보실수 있습니다.</p>
<div class="highlight"><pre><span></span>-rw-r--r-- <span class="m">1</span> test.ipynb

&gt; jupyter nbconvert --to notebook --execute test.ipynb
</pre></div>
<ul>
<li>--to notebook: 수행후 결과를 Notebook 파일 형태로 저장</li>
<li>--execute test.ipynb: 수행하고자 하는 Notebook 파일</li>
</ul>
<p>이제 Terminal 을 닫고 10초 정도 지난 뒤에 파일이 제대로 생성되었는지 확인해 보겠습니다.</p>
<div class="highlight"><pre><span></span>-rw-r--r-- <span class="m">1</span> test.ipynb
-rw-r--r-- <span class="m">1</span> test.log
-rw-r--r-- <span class="m">1</span> test.nbconvert.ipynb
&gt; cat test.log
<span class="m">1</span>
<span class="m">2</span>
<span class="m">3</span>
<span class="m">4</span>
<span class="m">5</span>
<span class="m">6</span>
<span class="m">7</span>
<span class="m">8</span>
<span class="m">9</span>
</pre></div>
<p>test.log 파일을 보면 노트북 파일이 제대로 수행되었음을 알 수 있습니다. 그리고 test.nbconvert.ipynb 파일을 Jupyter 상에서 열어보면 test.ipynb 파일의 결과 셀이 포함되어 있는 것을 확인하실 수 있습니다.</p>

</div>
</div>
</div>
 

